<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Estatística com R: Regressão Linear</title>

  <meta property="description" itemprop="description" content="Como mensurar efeitos de diversas variáveis independentes sobre uma variável dependente contínua."/>

  <link rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"/>

  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2021-01-11"/>
  <meta property="article:created" itemprop="dateCreated" content="2021-01-11"/>
  <meta name="article:author" content="Jose Storopoli"/>
  <meta name="article:author" content="Leonardo Vils"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Estatística com R: Regressão Linear"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Como mensurar efeitos de diversas variáveis independentes sobre uma variável dependente contínua."/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="Estatística com R"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Estatística com R: Regressão Linear"/>
  <meta property="twitter:description" content="Como mensurar efeitos de diversas variáveis independentes sobre uma variável dependente contínua."/>

  <!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
  <meta name="citation_title" content="Estatística com R: Regressão Linear"/>
  <meta name="citation_fulltext_html_url" content="https://storopoli.github.io/Estatistica/6-Regressao_Linear.html"/>
  <meta name="citation_fulltext_world_readable" content=""/>
  <meta name="citation_online_date" content="2021/01/11"/>
  <meta name="citation_publication_date" content="2021/01/11"/>
  <meta name="citation_author" content="Jose Storopoli"/>
  <meta name="citation_author_institution" content="UNINOVE"/>
  <meta name="citation_author" content="Leonardo Vils"/>
  <meta name="citation_author_institution" content="UNINOVE"/>
  <!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=An R companion to applied regression;citation_publication_date=2019;citation_publisher=Sage;citation_author=John Fox;citation_author=Sanford Weisberg"/>
  <meta name="citation_reference" content="citation_title=Robust estimation of a location parameter;citation_publication_date=1964;citation_publisher=The Institute of Mathematical Statistics;citation_volume=35;citation_doi=10.1214/aoms/1177703732;citation_author=Peter J. Huber"/>
  <meta name="citation_reference" content="citation_title=Least median of squares regression;citation_publication_date=1984;citation_publisher=Taylor &amp; Francis;citation_volume=79;citation_author=Peter J Rousseeuw"/>
  <meta name="citation_reference" content="citation_title=A note on studentizing a test for heteroscedasticity;citation_publication_date=1981;citation_publisher=Elsevier;citation_volume=17;citation_author=Roger Koenker"/>
  <meta name="citation_reference" content="citation_title=Statistical thinking for the 21st century;citation_publication_date=2018;citation_publisher=Self-published;citation_author=Russell A. Poldrack"/>
  <meta name="citation_reference" content="citation_title=Common statistical tests are linear models (or: How to teach stats);citation_publication_date=2019;citation_author=Jonas Kristoffer Lindelov"/>
  <meta name="citation_reference" content="citation_title=Regularization paths for cox’s proportional hazards model via coordinate descent;citation_publication_date=2011;citation_volume=39;citation_author=Noah Simon;citation_author=Jerome Friedman;citation_author=Trevor Hastie;citation_author=Rob Tibshirani"/>
  <meta name="citation_reference" content="citation_title=On the stability of inverse problems;citation_publication_date=1943;citation_volume=39;citation_author=Andrey Nikolayevich Tikhonov"/>
  <meta name="citation_reference" content="citation_title=Kinship and correlation;citation_publication_date=1890;citation_publisher=JSTOR;citation_volume=150;citation_author=Francis Galton"/>
  <meta name="citation_reference" content="citation_title=On the theory of correlation;citation_publication_date=1897;citation_publisher=JSTOR;citation_volume=60;citation_author=G Udny Yule"/>
  <meta name="citation_reference" content="citation_title=The law of ancestral heredity;citation_publication_date=1903;citation_publisher=Oxford University Press;citation_volume=2;citation_author=Karl Pearson"/>
  <meta name="citation_reference" content="citation_title=Generalized additive models;citation_publication_date=1986;citation_publisher=Institute of Mathematical Statistics;citation_volume=1;citation_author=Trevor Hastie;citation_author=Robert Tibshirani;citation_author=Generalized additive models"/>
  <meta name="citation_reference" content="citation_title=Gam: Generalized additive models;citation_publication_date=2020;citation_author=Trevor Hastie"/>
  <meta name="citation_reference" content="citation_title=Fitting linear mixed-effects models using lme4;citation_publication_date=2015;citation_volume=67;citation_doi=10.18637/jss.v067.i01;citation_author=Douglas Bates;citation_author=Martin Mächler;citation_author=Ben Bolker;citation_author=Steve Walker"/>
  <meta name="citation_reference" content="citation_title=Multilevel modeling;citation_publication_date=2019;citation_publisher=SAGE Publications, Incorporated;citation_volume=143;citation_author=Douglas A Luke"/>
  <meta name="citation_reference" content="citation_title=sjPlot: Data visualization for statistics in social science;citation_publication_date=2020;citation_author=Daniel Lüdecke"/>
  <meta name="citation_reference" content="citation_title=Ggfortify: Data visualization tools for statistical analysis results;citation_publication_date=2018;citation_author=Masaaki Horikoshi;citation_author=Yuan Tang"/>
  <meta name="citation_reference" content="citation_title=Diagnostic checking in regression relationships;citation_publication_date=2002;citation_volume=2;citation_author=Achim Zeileis;citation_author=Torsten Hothorn"/>
  <meta name="citation_reference" content="citation_title=Lm.beta: Add standardized regression coefficients to lm-objects;citation_publication_date=2014;citation_author=Stefan Behrendt"/>
  <meta name="citation_reference" content="citation_title=ggplot2: Elegant graphics for data analysis;citation_publication_date=2016;citation_publisher=Springer-Verlag New York;citation_author=Hadley Wickham"/>
  <meta name="citation_reference" content="citation_title=Multivariate data analysis;citation_publication_date=1998;citation_publisher=Prentice hall Upper Saddle River, NJ;citation_volume=5;citation_author=Joseph F Hair;citation_author=William C Black;citation_author=Barry J Babin;citation_author=Rolph E Anderson;citation_author=Ronald L Tatham;citation_author=Multivariate data analysis"/>
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","citation_url","slug","bibliography","csl"]}},"value":[{"type":"character","attributes":{},"value":["Regressão Linear"]},{"type":"character","attributes":{},"value":["Como mensurar efeitos de diversas variáveis independentes sobre uma variável dependente contínua.\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url","affiliation","affiliation_url","orcid_id"]}},"value":[{"type":"character","attributes":{},"value":["Jose Storopoli"]},{"type":"character","attributes":{},"value":["https://scholar.google.com/citations?user=xGU7H1QAAAAJ&hl=en"]},{"type":"character","attributes":{},"value":["UNINOVE"]},{"type":"character","attributes":{},"value":["https://www.uninove.br"]},{"type":"character","attributes":{},"value":["0000-0002-0559-5176"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url","affiliation","affiliation_url","orcid_id"]}},"value":[{"type":"character","attributes":{},"value":["Leonardo Vils"]},{"type":"character","attributes":{},"value":["https://scholar.google.com/citations?user=VO07L9EAAAAJ&hl=en"]},{"type":"character","attributes":{},"value":["UNINOVE"]},{"type":"character","attributes":{},"value":["https://www.uninove.br"]},{"type":"character","attributes":{},"value":["0000-0003-3059-1967"]}]}]},{"type":"character","attributes":{},"value":["January 11, 2021"]},{"type":"character","attributes":{},"value":["https://storopoli.github.io/Estatistica/6-Regressao_Linear.html"]},{"type":"character","attributes":{},"value":["storopoli2021regressaolinearR"]},{"type":"character","attributes":{},"value":["bibliografia.bib"]},{"type":"character","attributes":{},"value":["apa.csl"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>

  <script type="application/javascript">

    window.headroom_prevent_pin = false;

    window.document.addEventListener("DOMContentLoaded", function (event) {

      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');

      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });

      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });

      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>

  <style type="text/css">

  /* Theme (user-documented overrideables for nav appearance) */

  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }

  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }

  .distill-site-nav a:hover {
    color: white;
  }

  @media print {
    .distill-site-nav {
      display: none;
    }
  }

  .distill-site-header {

  }

  .distill-site-footer {

  }


  /* Site Header */

  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }


  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }

  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }

  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }

  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }



  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }


  .distill-site-header .nav-toggle {
    display: none;
  }

  .nav-dropdown {
    display: inline-block;
    position: relative;
  }

  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }

  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .nav-dropdown-active {
    display: block;
  }

  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }

  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }

  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }

  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }


  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }

  /* Site Footer */

  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }

  /* Headroom */

  d-title {
    padding-top: 6rem;
  }

  @media print {
    d-title {
      padding-top: 4rem;
    }
  }

  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }

  .headroom--transition {
    transition: all .4s ease-in-out;
  }

  .headroom--unpinned {
    top: -100px;
  }

  .headroom--pinned {
    top: 0;
  }

  </style>

  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>

  <script type="application/javascript">

  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }

  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }

  function createFuseIndex() {

    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);

    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });

        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;

    createFuseIndex()
      .then(function(fuse) {

        // make search box visible
        searchEl.classList.remove('hidden');

        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
              .filter(function(item) { return !!item.description; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description}
                  </div>
                  <div class="search-item-preview">
                    <img src="${suggestion.preview ? offsetURL(suggestion.preview) : ''}"</img>
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });

  });

  </script>

  <style type="text/css">

  /* Algolioa Autocomplete */

  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }


  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }

  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }

  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    margin-block-start: 0;
    margin-block-end: 5px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }

  </style>


  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <style type="text/css">
  /* base variables */

  /* Edit the CSS properties in this file to create a custom
     Distill theme. Only edit values in the right column
     for each row; values shown are the CSS defaults.
     To return any property to the default,
     you may set its value to: unset
     All rows must end with a semi-colon.                      */

  /* Optional: embed custom fonts here with `@import`          */
  /* This must remain at the top of this file.                 */



  html {
    /*-- Main font sizes --*/
    --title-size:      50px;
    --body-size:       1.06rem;
    --code-size:       14px;
    --aside-size:      12px;
    --fig-cap-size:    13px;
    /*-- Main font colors --*/
    --title-color:     #000000;
    --header-color:    rgba(0, 0, 0, 0.8);
    --body-color:      rgba(0, 0, 0, 0.8);
    --aside-color:     rgba(0, 0, 0, 0.6);
    --fig-cap-color:   rgba(0, 0, 0, 0.6);
    /*-- Specify custom fonts ~~~ must be imported above   --*/
    --heading-font:    sans-serif;
    --mono-font:       monospace;
    --body-font:       sans-serif;
    --navbar-font:     sans-serif;  /* websites + blogs only */
  }

  /*-- ARTICLE METADATA --*/
  d-byline {
    --heading-size:    0.6rem;
    --heading-color:   rgba(0, 0, 0, 0.5);
    --body-size:       0.8rem;
    --body-color:      rgba(0, 0, 0, 0.8);
  }

  /*-- ARTICLE TABLE OF CONTENTS --*/
  .d-contents {
    --heading-size:    18px;
    --contents-size:   13px;
  }

  /*-- ARTICLE APPENDIX --*/
  d-appendix {
    --heading-size:    15px;
    --heading-color:   rgba(0, 0, 0, 0.65);
    --text-size:       0.8em;
    --text-color:      rgba(0, 0, 0, 0.5);
  }

  /*-- WEBSITE HEADER + FOOTER --*/
  /* These properties only apply to Distill sites and blogs  */

  .distill-site-header {
    --title-size:       18px;
    --text-color:       rgba(255, 255, 255, 0.8);
    --text-size:        15px;
    --hover-color:      white;
    --bkgd-color:       #0F2E3D;
  }

  .distill-site-footer {
    --text-color:       rgba(255, 255, 255, 0.8);
    --text-size:        15px;
    --hover-color:      white;
    --bkgd-color:       #0F2E3D;
  }

  /*-- Additional custom styles --*/
  /* Add any additional CSS rules below                      */
  </style>
  <style type="text/css">
  /* base variables */

  /* Edit the CSS properties in this file to create a custom
     Distill theme. Only edit values in the right column
     for each row; values shown are the CSS defaults.
     To return any property to the default,
     you may set its value to: unset
     All rows must end with a semi-colon.                      */

  /* Optional: embed custom fonts here with `@import`          */
  /* This must remain at the top of this file.                 */



  html {
    /*-- Main font sizes --*/
    --title-size:      50px;
    --body-size:       1.06rem;
    --code-size:       14px;
    --aside-size:      12px;
    --fig-cap-size:    13px;
    /*-- Main font colors --*/
    --title-color:     #000000;
    --header-color:    rgba(0, 0, 0, 0.8);
    --body-color:      rgba(0, 0, 0, 0.8);
    --aside-color:     rgba(0, 0, 0, 0.6);
    --fig-cap-color:   rgba(0, 0, 0, 0.6);
    /*-- Specify custom fonts ~~~ must be imported above   --*/
    --heading-font:    sans-serif;
    --mono-font:       monospace;
    --body-font:       sans-serif;
    --navbar-font:     sans-serif;  /* websites + blogs only */
  }

  /*-- ARTICLE METADATA --*/
  d-byline {
    --heading-size:    0.6rem;
    --heading-color:   rgba(0, 0, 0, 0.5);
    --body-size:       0.8rem;
    --body-color:      rgba(0, 0, 0, 0.8);
  }

  /*-- ARTICLE TABLE OF CONTENTS --*/
  .d-contents {
    --heading-size:    18px;
    --contents-size:   13px;
  }

  /*-- ARTICLE APPENDIX --*/
  d-appendix {
    --heading-size:    15px;
    --heading-color:   rgba(0, 0, 0, 0.65);
    --text-size:       0.8em;
    --text-color:      rgba(0, 0, 0, 0.5);
  }

  /*-- WEBSITE HEADER + FOOTER --*/
  /* These properties only apply to Distill sites and blogs  */

  .distill-site-header {
    --title-size:       18px;
    --text-color:       rgba(255, 255, 255, 0.8);
    --text-size:        15px;
    --hover-color:      white;
    --bkgd-color:       #0F2E3D;
  }

  .distill-site-footer {
    --text-color:       rgba(255, 255, 255, 0.8);
    --text-size:        15px;
    --hover-color:      white;
    --bkgd-color:       #0F2E3D;
  }

  /*-- Additional custom styles --*/
  /* Add any additional CSS rules below                      */
  @import url('https://cdn.rawgit.com/jpswalsh/academicons/master/css/academicons.min.css')</style>
  <style type="text/css">
  /* base style */

  /* FONT FAMILIES */

  :root {
    --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  body,
  .posts-list .post-preview p,
  .posts-list .description p {
    font-family: var(--body-font), var(--body-default);
  }

  h1, h2, h3, h4, h5, h6,
  .posts-list .post-preview h2,
  .posts-list .description h2 {
    font-family: var(--heading-font), var(--heading-default);
  }

  d-article div.sourceCode code,
  d-article pre code {
  	font-family: var(--mono-font), var(--mono-default);
  }


  /*-- TITLE --*/
  d-title h1,
  .posts-list > h1 {
    color: var(--title-color, black);
  }

  d-title h1 {
    font-size: var(--title-size, 50px);
  }

  /*-- HEADERS --*/
  d-article h1,
  d-article h2,
  d-article h3,
  d-article h4,
  d-article h5,
  d-article h6 {
    color: var(--header-color, rgba(0, 0, 0, 0.8));
  }

  /*-- BODY --*/
  /* only text inside of <p> tags */
  d-article > p {
    color: var(--body-color, rgba(0, 0, 0, 0.8));
    font-size: var(--body-size, 1.06rem);
  }

  /*-- CODE --*/
  d-article div.sourceCode code,
  d-article pre code {
  	font-size: var(--code-size, 14px);
  }

  /*-- ASIDE --*/
  d-article aside {
  	font-size: var(--aside-size, 12px);
  	color: var(--aside-color, rgba(0, 0, 0, 0.6));
  }

  /*-- FIGURE CAPTIONS --*/
  figure .caption,
  figure figcaption,
  .figure .caption {
  	font-size: var(--fig-cap-size, 13px);
  	color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
  }

  /*-- METADATA --*/
  d-byline h3 {
  	font-size: var(--heading-size, 0.6rem);
  	color: var(--heading-color, rgba(0, 0, 0, 0.5));
  }

  d-byline {
  	font-size: var(--body-size, 0.8rem);
  	color: var(--body-color, rgba(0, 0, 0, 0.8));
  }

  d-byline a,
  d-article d-byline a {
  	color: var(--body-color, rgba(0, 0, 0, 0.8));
  }

  /*-- TABLE OF CONTENTS --*/
  .d-contents nav h3 {
  	font-size: var(--heading-size, 18px);
  }

  .d-contents nav a {
  	font-size: var(--contents-size, 13px);
  }

  /*-- APPENDIX --*/
  d-appendix h3 {
    font-size: var(--heading-size, 15px);
  	color: var(--heading-color, rgba(0, 0, 0, 0.65));
  }

  d-appendix {
    font-size: var(--text-size, 0.8em);
  	color: var(--text-color, rgba(0, 0, 0, 0.5));
  }

  d-appendix d-footnote-list a.footnote-backlink {
  	color: var(--text-color, rgba(0, 0, 0, 0.5));
  }

  /*-- WEBSITE HEADER + FOOTER --*/
  .distill-site-header .title {
  	font-size: var(--title-size, 18px);
  	font-family: var(--navbar-font), var(--heading-default);
  }

  .distill-site-header a,
  .nav-dropdown .nav-dropbtn {
    font-family: var(--navbar-font), var(--heading-default);
  }

  .distill-site-header a:hover {
  	color: var(--hover-color, white);
  }

  .distill-site-header {
  	font-size: var(--text-size, 15px);
  	color: var(--text-color, rgba(255, 255, 255, 0.8));
  	background-color: var(--bkgd-color, #0F2E3D);
  }

  .distill-site-footer {
  	font-size: var(--text-size, 15px);
  	color: var(--text-color, rgba(255, 255, 255, 0.8));
  	background-color: var(--bkgd-color, #0F2E3D);
  }

  .distill-site-footer a:hover {
  	color: var(--hover-color, white);
  }</style>
  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.6/header-attrs.js"></script>
  <script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-BDZ8MJ5HY1"></script>
  <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-BDZ8MJ5HY1');
  </script>
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Regressão Linear","description":"Como mensurar efeitos de diversas variáveis independentes sobre uma variável dependente contínua.","authors":[{"author":"Jose Storopoli","authorURL":"https://scholar.google.com/citations?user=xGU7H1QAAAAJ&hl=en","affiliation":"UNINOVE","affiliationURL":"https://www.uninove.br","orcidID":"0000-0002-0559-5176"},{"author":"Leonardo Vils","authorURL":"https://scholar.google.com/citations?user=VO07L9EAAAAJ&hl=en","affiliation":"UNINOVE","affiliationURL":"https://www.uninove.br","orcidID":"0000-0003-3059-1967"}],"publishedDate":"2021-01-11T00:00:00.000+00:00","citationText":"Storopoli & Vils, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="https://www.uninove.br">
<img src="images/uninove.png" alt="Logo"/>
</a>
<a href="index.html" class="title">Estatística com R</a>
<a href="0-Por_que_R.html">Por que R?</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Tutoriais
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="1-Comandos_Basicos.html">1. Comandos Básicos</a>
<a href="2-p-valores.html">2. p-valores, Ho e Pressupostos</a>
<a href="3-Teste_t.html">3. Teste t</a>
<a href="4-ANOVA.html">4. ANOVA</a>
<a href="5-Correlacoes.html">5. Correlações</a>
<a href="6-Regressao_Linear.html">6. Regressão Linear</a>
<a href="7-Regressao_Logistica.html">7. Regressão Logística</a>
</div>
</div>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Conteúdos Auxiliares
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="aux-Anscombe.html">Quarteto de Anscombe</a>
<a href="aux-Dados_Faltantes.html">Dados Faltantes</a>
<a href="aux-Tamanho_Amostra.html">Tamanho de Amostra e Tamanho de Efeito</a>
<a href="aux-Tabelas_para_Publicacao.html">Tabelas para Publicação</a>
</div>
</div>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="https://scholar.google.com/citations?user=xGU7H1QAAAAJ&amp;hl=en">
<i class="fa ai ai-google-scholar ai-lg" aria-hidden="true"></i>
</a>
<a href="https://orcid.org/0000-0002-0559-5176">
<i class="fa ai ai-orcid ai-lg" aria-hidden="true"></i>
</a>
<a href="http://lattes.cnpq.br/2281909649311607">
<i class="fa ai ai-lattes ai-lg" aria-hidden="true"></i>
</a>
<a href="https://github.com/storopoli/Estatistica" aria-label="Link to source">
<i class="fab fa-github" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Regressão Linear</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>Como mensurar efeitos de diversas variáveis independentes sobre uma variável dependente contínua.</p></p>
</div>

<div class="d-byline">
  Jose Storopoli <a href="https://scholar.google.com/citations?user=xGU7H1QAAAAJ&amp;hl=en" class="uri">https://scholar.google.com/citations?user=xGU7H1QAAAAJ&amp;hl=en</a> (UNINOVE)<a href="https://www.uninove.br" class="uri">https://www.uninove.br</a>
  
,   Leonardo Vils <a href="https://scholar.google.com/citations?user=VO07L9EAAAAJ&amp;hl=en" class="uri">https://scholar.google.com/citations?user=VO07L9EAAAAJ&amp;hl=en</a> (UNINOVE)<a href="https://www.uninove.br" class="uri">https://www.uninove.br</a>
  
<br/>January 11, 2021
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#interpretações">Interpretações</a>
<ul>
<li><a href="#interpretação-geométrica">Interpretação Geométrica</a></li>
<li><a href="#interpretação-matemática">Interpretação Matemática</a></li>
<li><a href="#interpretação-estatística">Interpretação Estatística</a></li>
</ul></li>
<li><a href="#história-da-regressão">História da Regressão</a></li>
<li><a href="#pressupostos-da-regressão-linear">Pressupostos da Regressão Linear</a></li>
<li><a href="#como-aplicar-uma-regressão-linear-no-r">Como aplicar uma Regressão Linear no R</a>
<ul>
<li><a href="#interpretação-dos-coeficientes">Interpretação dos Coeficientes</a></li>
<li><a href="#variáveis-qualitativas">Variáveis Qualitativas</a></li>
<li><a href="#efeitos-principais-e-efeitos-de-interação">Efeitos Principais e Efeitos de Interação</a></li>
<li><a href="#efeitos-não-lineares">Efeitos Não-Lineares</a></li>
<li><a href="#visualização-de-regressão-linear">Visualização de Regressão Linear</a></li>
<li><a href="#verificação-de-pressupostos">Verificação de Pressupostos</a></li>
</ul></li>
<li><a href="#r2-e-r2-ajustado"><span class="math inline">\(R^2\)</span> e <span class="math inline">\(R^2\)</span> ajustado</a></li>
<li><a href="#coeficientes-brutos-versus-padronizados">Coeficientes Brutos versus Padronizados</a></li>
<li><a href="#conexões-com-o-teste-t-anova-e-correlações">Conexões com o Teste <span class="math inline">\(t\)</span>, ANOVA e Correlações</a></li>
<li><a href="#técnicas-avançadas-de-regressão-linear">Técnicas Avançadas de Regressão Linear</a>
<ul>
<li><a href="#regressão-robusta">Regressão Robusta</a></li>
<li><a href="#regressão-regularizada">Regressão Regularizada</a></li>
<li><a href="#regressão-aditiva---modelos-aditivos-generalizados">Regressão Aditiva - Modelos Aditivos Generalizados</a></li>
<li><a href="#regressão-multinível">Regressão Multinível</a></li>
</ul></li>
<li><a href="#comentários-finais">Comentários Finais</a></li>
<li><a href="#ambiente">Ambiente</a></li>
</ul>
</nav>
</div>
<p><link rel="stylesheet" href="https://cdn.rawgit.com/jpswalsh/academicons/master/css/academicons.min.css"/></p>
<p>Muitas vezes precisamos de técnicas que tolerem varíaveis independente contínuas. Não conseguimos usar ANOVA pois as variáveis independentes são discretas e representam grupos distintos de observações (uma variável independente – Anova Unidireacional, duas variáveis independentes – Anova Bidirecional, etc.). Muito menos teste <span class="math inline">\(t\)</span>, pois segue o mesmo princípio da ANOVA mas se restringindo a apenas dois grupos, ou seja, apenas variável independente categórica binária. Para isso temos a técnica de Regressão Linear.</p>
<aside>
Regressão Linear é a técnica preferida do autor 1
</aside>
<p><strong>Regressão linear permite com que você use uma ou mais variáveis discretas ou contínuas como variáveis independentes e mensurar o poder de associação com a variável dependente, que deve ser contínua</strong><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<h2 id="interpretações">Interpretações</h2>
<p>Para compreender regressão linear podemos usar de três interpretações distintas mas complementares:</p>
<ul>
<li><strong>Interpretação Geométrica</strong>: Regressão como uma reta.</li>
<li><strong>Interpretação Matemática</strong>: Regressão como otimização.</li>
<li><strong>Interpretação Estatística</strong>: Regressão como poder de associação entre variáveis controlando para diversos outros efeitos.</li>
</ul>
<p>Essas interpretações descrevem a mesma técnica mas sob aspectos diferentes. Lembra um pouco a metáfora dos sete sábios e o elefante (figura <a href="#fig:sete-sabios">1</a>):</p>
<blockquote>
<p>Numa pequena cidade viviam sete sábios cegos. Por conta de sua reconhecida sabedoria, as pessoas os procuravam em busca de conselhos para solução de seus problemas. Apesar de amigos, os sábios mantinham entre si uma competitividade acirrada, discutiam o tempo todo tentando provar quem era o mais sábio. Um dia trouxeram um elefante para a cidade. Os cegos rodearam o elefante para tocá-lo. Cada um pegou em uma parte distinta do animal e o descreve de acordo com aquela parte. Eles estão descrevendo o mesmo animal, mas cada um descrevendo apenas uma parte e pensando que é o todo. Eles estão, ao mesmo tempo, certos e errados<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>.</p>
</blockquote>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span id="fig:sete-sabios"></span>
<img src="images/elephant-parable.jpg" alt="Os Sete Sábios e o Elefante. Figura de https://nsjour.wordpress.com/2012/10/21/seven-blind-men-and-the-elephant/" width="70%" class=external />
<p class="caption">
Figure 1: Os Sete Sábios e o Elefante. Figura de <a href="https://nsjour.wordpress.com/2012/10/21/seven-blind-men-and-the-elephant/" class="uri">https://nsjour.wordpress.com/2012/10/21/seven-blind-men-and-the-elephant/</a>
</p>
</div>
</div>
<h3 id="interpretação-geométrica">Interpretação Geométrica</h3>
<p>Imagine que seus dados são pontos que vivem em um espaço multidimensional. <strong>A regressão é uma técnica para encontrar a melhor reta<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> entre o conjunto de dados levando em conta todas as observações</strong>.</p>
<p>Isto é valido para qualquer espaço multidimensional, até para além de 3-D. Vamos mostrar um exemplo em 2-D da relação entre <code>x</code> e <code>y</code><a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>, mas isto poder ser estendido para a relação <code>x1</code>, <code>x2</code>, … e <code>y</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span id="fig:regressao-reta"></span>
<img src="6-Regressao_Linear_files/figure-html5/regressao-reta-1.png" alt="Uma relação entre variáveis representada por uma reta de tendência" width="70%" />
<p class="caption">
Figure 2: Uma relação entre variáveis representada por uma reta de tendência
</p>
</div>
</div>
<p>Vejam que regressão linear usando apenas uma variável dependente e uma variável independente é a mesma coisa que que correlação<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>.</p>
<h3 id="interpretação-matemática">Interpretação Matemática</h3>
<p><strong>A interpretação matemática é vista como uma otimização: encontrar a melhor reta entre os pontos que minimiza o erro quadrático médio (<em>mean squared error</em> – MSE)</strong>. Ao escolhermos a melhor reta, devemos escolher a melhor reta que minimiza as distâncias entre os pontos, sendo que podemos errar para mais ou para menos. Para evitarmos que os erros se cancelem, precisamos eliminar o sinal negativo de alguns erros e convertê-los para valores positivos. Para isso, pegamos todas os erros (diferenças entre o valor previsto pela reta e o valor verdadeiro) e elevamos ao quadrado (assim todo número negativo se tornará positivo e todo positivo se manterá positivo)<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>. Portanto, a <strong>regressão se torna a busca do menor valor de uma função erro (MSE)</strong><a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span id="fig:regressao-mse"></span>
<img src="6-Regressao_Linear_files/figure-html5/regressao-mse-1.png" alt="A melhor reta que minimiza a distância dos erros" width="70%" />
<p class="caption">
Figure 3: A melhor reta que minimiza a distância dos erros
</p>
</div>
</div>
<h3 id="interpretação-estatística">Interpretação Estatística</h3>
<p>A regressão linear usando uma única variável independente contínua se torna exatamente uma correlação<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a>. Agora quando empregamos mais de uma variável independente, a interpretação da regressão se torna: <strong>“O efeito de <code>X</code> em <code>Y</code> mantendo <code>Z</code> fixo”</strong>. Isto quer dizer que a regressão lienar <strong>controla os efeitos das diferentes variáveis independentes ao calcular o efeito de uma certa variável independente</strong>. Esta é o que chamamos de <strong>interpretação estatística</strong> da regressão linear.</p>
<p>Por exemplo, digamos que você esteja em busca dos fatores que acarretam ataque cardíaco. Você coleta dados de pessoas que quantifiquem as seguintes variáveis: sono, stress, tabagismo, sedentarismo, entre outros… A regressão te permite mensurar o efeito de qualquer uma dessas variáveis na prevalência de ataque cardíaco controlando para outros efeitos. Em outras palavras, é possível mensurar o efeito de stress em ataque cardíaco, mantendo fixo os efeitos de sono, tabagismo, psedentarismo, etc… Isso permite você isolar o efeito de uma variável sem deixar que outras variáveis a influenciem na mensuração da sua relação com a variável dependente (no nosso caso: ataque cardíaco).</p>
<h2 id="história-da-regressão">História da Regressão</h2>
<p>O termo “regressão” foi cunhado por Francis Galton no século XIX para descrever um fenômeno biológico. O fenômeno era que as alturas dos descendentes de ancestrais altos tendem a regredir para uma média normal (um fenômeno também conhecido como regressão em direção à média) <span class="citation" data-cites="galton1890kinship">(<a href="#ref-galton1890kinship" role="doc-biblioref">Galton, 1890</a>)</span>. Para Galton, a regressão tinha apenas este significado biológico [@ galton1877typical], mas seu trabalho foi posteriormente estendido por Udny Yule <span class="citation" data-cites="yule1897theory">(<a href="#ref-yule1897theory" role="doc-biblioref">Yule, 1897</a>)</span> e Karl Pearson <span class="citation" data-cites="pearson1903law">(<a href="#ref-pearson1903law" role="doc-biblioref">Pearson, 1903</a>)</span> para um contexto estatístico mais geral.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span id="fig:fig-galton-pearson-yule"></span>
<img src="6-Regressao_Linear_files/figure-html5/fig-galton-pearson-yule-1.png" alt="Da esquerda para direita: Francis Galton, Karl Pearson e Udny Yule -- Figuras de https://www.wikipedia.org" width="20%" class=external />
<p class="caption">
Figure 4: Da esquerda para direita: Francis Galton, Karl Pearson e Udny Yule – Figuras de <a href="https://www.wikipedia.org" class="uri">https://www.wikipedia.org</a>
</p>
</div>
</div>
<h2 id="pressupostos-da-regressão-linear">Pressupostos da Regressão Linear</h2>
<p>Para interpretar os resultados de uma regressão como uma quantidade estatística significativa que mede os relacionamentos do mundo real, precisamos contar com uma série de suposições clássicas. Os quatro principais pressupostos da regressão são:</p>
<ol type="1">
<li><strong>Independência dos Dados</strong>: o valor de uma observação não influencia ou afeta o valor de outras observações. Este é o pressuposto clássico de todas as técnicas abordadas até agora.</li>
<li><strong>Linearidade dos Dados</strong>: a relação entre as variáveis independentes e a variável dependente é considerada linear (quanto mais/menos de uma, mais/menos de outra). Linearidade dos Dados pode ser verificada graficamente observando a dispersão dos resíduos com os valores previstos pela regressão.</li>
<li><strong>Independência dos Erros / Resíduos</strong>: os erros (também chamados de resíduos) não devem possuir correlação. Este pressuposto pode ser testado pelo teste de Durbin-Watson e observando o gráfico quantil-quantil (Q-Q) dos resíduos padronizados.</li>
<li><strong>Homogeneidade de Variância dos Erros / Resíduos</strong>: os erros devem ter média zero e desvio padrão constante ao longo das observações. Similar ao teste de Levene, mas aplicado aos resíduos da regressão. Pode ser testado usando o Teste de Breusch-Pagan.</li>
<li><strong>Ausência de Multicolinearidade</strong>: multicolinearidade é a ocorrência de alta correlação entre duas ou mais variáveis independentes e pode levar a resultados distorcidos. Em geral, a multicolinearidade pode fazer com que os intervalos de confiança se ampliem, ou até mudar o sinal de influência das variáveis independentes (de positivo para negativo, por exemplo). Portanto, as inferências estatísticas de uma regressão com multicolinearidade não são confiáveis. Pode ser testado usando o Fator de Inflação de Variância (<em>Variance Inflation Factor</em> – VIF).</li>
</ol>
<h2 id="como-aplicar-uma-regressão-linear-no-r">Como aplicar uma Regressão Linear no R</h2>
<p>Para exemplificar as regressões nesse tutorial, usaremos o <em>dataset</em> já incluido no R <code>mtcars</code> <span class="citation" data-cites="henderson1981building">(<a href="#ref-henderson1981building" role="doc-biblioref">Henderson &amp; Velleman, 1981</a>)</span>. <code>mtcars</code> é uma base de dados extraída da revista americana sobre carros <em>Motor Trend US</em> de 1974. Possui 32 observações de carros e 11 variáveis:</p>
<ul>
<li><code>mpg</code>: Milhas por Galão (consumo)</li>
<li><code>cyl</code>: Número de cilíndros</li>
<li><code>disp</code>: Cilindada (em polegada cúbica)</li>
<li><code>hp</code>: Cavalos de Potência (HP)</li>
<li><code>drat</code>: Relação do eixo traseiro</li>
<li><code>wt</code>: Peso em (1,000 libras)</li>
<li><code>qsec</code>: Tempo que atinge 400m (1/4 de milha)</li>
<li><code>vs</code>: Motor (0 = Forma em V, 1 = Reto)</li>
<li><code>am</code>: Transmissão (0 = Automático, 1 = Manual)</li>
<li><code>gear</code>: Número de marchas</li>
<li><code>carb</code>: Número de carburadores</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://docs.ropensci.org/skimr'>skimr</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>mtcars</span><span class='op'>)</span>
<span class='fu'><a href='https://docs.ropensci.org/skimr/reference/skim.html'>skim</a></span><span class='op'>(</span><span class='va'>mtcars</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<caption><span id="tab:skim-mtcars">Table 1: </span>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">mtcars</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">32</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">11</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">mpg</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">20.09</td>
<td style="text-align: right;">6.03</td>
<td style="text-align: right;">10.4</td>
<td style="text-align: right;">15.4</td>
<td style="text-align: right;">19.2</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">33.9</td>
<td style="text-align: left;">▃▇▅▁▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">cyl</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6.19</td>
<td style="text-align: right;">1.79</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: left;">▆▁▃▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">disp</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">230.72</td>
<td style="text-align: right;">123.94</td>
<td style="text-align: right;">71.1</td>
<td style="text-align: right;">120.8</td>
<td style="text-align: right;">196.3</td>
<td style="text-align: right;">326.0</td>
<td style="text-align: right;">472.0</td>
<td style="text-align: left;">▇▃▃▃▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">hp</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">146.69</td>
<td style="text-align: right;">68.56</td>
<td style="text-align: right;">52.0</td>
<td style="text-align: right;">96.5</td>
<td style="text-align: right;">123.0</td>
<td style="text-align: right;">180.0</td>
<td style="text-align: right;">335.0</td>
<td style="text-align: left;">▇▇▆▃▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">drat</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.60</td>
<td style="text-align: right;">0.53</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">4.9</td>
<td style="text-align: left;">▇▃▇▅▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">wt</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.22</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">3.6</td>
<td style="text-align: right;">5.4</td>
<td style="text-align: left;">▃▃▇▁▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">qsec</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">17.85</td>
<td style="text-align: right;">1.79</td>
<td style="text-align: right;">14.5</td>
<td style="text-align: right;">16.9</td>
<td style="text-align: right;">17.7</td>
<td style="text-align: right;">18.9</td>
<td style="text-align: right;">22.9</td>
<td style="text-align: left;">▃▇▇▂▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">vs</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: left;">▇▁▁▁▆</td>
</tr>
<tr class="odd">
<td style="text-align: left;">am</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: left;">▇▁▁▁▆</td>
</tr>
<tr class="even">
<td style="text-align: left;">gear</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.69</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: left;">▇▁▆▁▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">carb</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.81</td>
<td style="text-align: right;">1.62</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: left;">▇▂▅▁▁</td>
</tr>
</tbody>
</table>
</div>
<p>Para aplicar uma regressão linear no R usamos a função <code>lm()</code> (<em><strong>l</strong>inear <strong>m</strong>odel</em>) padrão do R. Sua funcionalidade é muito similar à outras funções que já vimos de teste de hipótese, sendo que é necessário fornecer dois argumentos:</p>
<ol type="1">
<li>Fórmula designando a variável dependente e a(s) variável(eis) independente(s) designada pela seguinte síntaxe: <code>dependente ~ independente_1 + independente_2 + ...</code>.</li>
<li>O <em>dataset</em> no qual deverá ser encontradas as variáveis presentes na fórmula.</li>
</ol>
<p>Começaremos com um exemplo simples de regressão do <code>mtcars</code> usando como variável independente <code>mpg</code> e variáveis independentes <code>hp</code> e <code>wt</code>. Podemos inspecionar o resultado de uma regressão linear com a função <code>summary()</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>modelo_simples</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>mpg</span> <span class='op'>~</span> <span class='va'>hp</span> <span class='op'>+</span> <span class='va'>wt</span>, data <span class='op'>=</span> <span class='va'>mtcars</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>modelo_simples</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Call:
lm(formula = mpg ~ hp + wt, data = mtcars)

Residuals:
   Min     1Q Median     3Q    Max 
-3.941 -1.600 -0.182  1.050  5.854 

Coefficients:
            Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept) 37.22727    1.59879   23.28 &lt; 0.0000000000000002 ***
hp          -0.03177    0.00903   -3.52               0.0015 ** 
wt          -3.87783    0.63273   -6.13            0.0000011 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 2.6 on 29 degrees of freedom
Multiple R-squared:  0.827, Adjusted R-squared:  0.815 
F-statistic: 69.2 on 2 and 29 DF,  p-value: 0.00000000000911</code></pre>
</div>
<h3 id="interpretação-dos-coeficientes">Interpretação dos Coeficientes</h3>
<p>Na saída de <code>summary()</code> podemos ver que são produzidos os <strong>coeficientes da regressão na coluna <code>Estimate</code></strong>, associados ao respectivos desvio padrão dos resíduos <code>Std. Error</code> e <span class="math inline">\(p\)</span>-valores <code>Pr(&gt;|t|)</code>. Importante destacar que a <strong>hipótese nula dos coeficientes da regressão é de que “os coeficientes são nulos/zeros”</strong>, então os <span class="math inline">\(p\)</span>-valores devem ser interpretados como <strong>a probabilidade de observamos valores de coeficientes tão extremos dado que a hipótese nula é verdadeira</strong>. Para facilitar, o R informa com asteriscos quais variáveis possuem coeficientes estatisticamente significantes: <code>*</code> para <span class="math inline">\(p &lt; 0.05\)</span>, <code>**</code> para <span class="math inline">\(p &lt; 0.01\)</span>, e <code>***</code> para <span class="math inline">\(p &lt; 0.001\)</span>.</p>
<p>Os coeficientes de objetos <code>lm</code> devem ser interpretados em <strong>escala bruta</strong> na qual <strong>o acréscimo de 1 unidade da variável independente gera o aumento de <code>&lt;coeficiente&gt;</code> unidade(s) da variável dependente</strong>. No nosso exemplo, a cada acréscimo de 1 <code>hp</code>, <code>mpg</code> reduz em -0.03; e a cada acréscimo de 1 <code>wt</code>, <code>mpg</code> reduz em -3.88. Além disso, a <strong>regressão linear controla os efeitos de outras variáveis indepedente</strong>. Então o impacto de <code>hp</code> em <code>mpg</code> no nosso exemplo controla o efeito de <code>wt</code>, matendo-o fixo ao calcular o coeficiente de <code>hp</code>.</p>
<p>O coeficiente <code>(Intercept)</code> é o que chamamos de constante (<em>intercept</em>) da regressão. <strong>A constante representa o valor médio da variável dependente quando todas as variáveis independentes possuem valor nulo (zero)</strong>. No nosso exemplo, as observações possuem em média 37.23 <code>mpg</code> quando tanto <code>hp</code> e <code>wt</code> são 0.</p>
<p>Note que podemos produzir <strong>intervalos de confiança usando a função padrão do R <code>confint()</code> inserindo como argumento um objeto <code>lm</code></strong>. <code>confint()</code> como padrão produz intervalos de confiança 95%.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>modelo_simples</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>            2.5 % 97.5 %
(Intercept) 33.96 40.497
hp          -0.05 -0.013
wt          -5.17 -2.584</code></pre>
</div>
<h3 id="variáveis-qualitativas">Variáveis Qualitativas</h3>
<p>Além de variáveis independentes quantitativas, regressão linear também permite utilizarmos <strong>variáveis qualitativas (discretas)</strong> como variáveis independentes.</p>
<p>Vamos estender o nosso modelo simples adicionando a variável <code>am</code>. Note que vamos convertê-la para qualitativa (<code>factor</code>) usando a função padrão do R <code>as.factor()</code>, Isto é necessário para que o R interprete <code>am</code> como fator (nomenclatura do R para variáveis qualitativas).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>modelo_quali</span> <span class='op'>&lt;-</span> <span class='va'>mtcars</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>am <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>am</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>mpg</span> <span class='op'>~</span> <span class='va'>hp</span> <span class='op'>+</span> <span class='va'>wt</span> <span class='op'>+</span> <span class='va'>am</span>, data <span class='op'>=</span> <span class='va'>.</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>modelo_quali</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Call:
lm(formula = mpg ~ hp + wt + am, data = .)

Residuals:
   Min     1Q Median     3Q    Max 
-3.422 -1.792 -0.379  1.225  5.532 

Coefficients:
            Estimate Std. Error t value         Pr(&gt;|t|)    
(Intercept) 34.00288    2.64266   12.87 0.00000000000028 ***
hp          -0.03748    0.00961   -3.90          0.00055 ***
wt          -2.87858    0.90497   -3.18          0.00357 ** 
am1          2.08371    1.37642    1.51          0.14127    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 2.5 on 28 degrees of freedom
Multiple R-squared:  0.84,  Adjusted R-squared:  0.823 
F-statistic:   49 on 3 and 28 DF,  p-value: 0.0000000000291</code></pre>
</div>
<p>Quando convertemos uma variável para fator, o R rotula os diferentes níveis (<em>levels</em>) conforme ordem alfabética. Portanto, no nosso exemplo, <code>am</code> possui 2 níveis: <code>0</code> e <code>1</code> (apesar de serem números, na conversão o R usa uma ordem crescrente para digitos). Numa regressão linear que possua variáveis qualitativas codificadas como fatores, o R usará o primeiro nível do fator (no nosso caso <code>am0</code>) como referência. Portanto a interpretação do coeficiente <code>am1</code> deve ser a seguinte: observações com <code>am = 1</code> possuem um acréscimo em média de 2.08 <code>mpg</code>. Note também que a variável <code>am</code> não possui significância estatística para a difença entre o nível de referência <code>am0</code> e o nível <code>am1</code> com <span class="math inline">\(p = 0.14\)</span>. É possível verificar os diferentes níveis das variáveis qualitativas de um objeto <code>lm</code> acessando seu atributo <code>xlevels</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>modelo_quali</span><span class='op'>$</span><span class='va'>xlevels</span>
</code></pre>
</div>
<pre><code>$am
[1] &quot;0&quot; &quot;1&quot;</code></pre>
</div>
<h3 id="efeitos-principais-e-efeitos-de-interação">Efeitos Principais e Efeitos de Interação</h3>
<p>Todos os modelos de regressão que mostramos até aqui usaram apenas efeitos principais. Mas <strong>podemos também mostrar efeitos de interação (também chamados de efeitos de moderação) entre duas variáveis</strong>. Similar ao exposto no <a href="4-ANOVA.html">tutorial sobre ANOVA</a>, podemos incluir <strong>dois tipos de efeitos na regressão linear</strong>:</p>
<ul>
<li><strong>Efeitos principais</strong>: efeito de uma (ou mais) variável(is) independente(s) em uma variável dependente. Chamamos esses efeitos de <strong>aditivos</strong> pois podem ser quebrados em dois efeitos distintos e únicos que estão influenciando a variável dependente.</li>
<li><strong>Efeitos de interações</strong>: quando o efeito de uma (ou mais) variável(is) independente(s) em uma variável dependente é afetado pelo nível de outras variável(is) independente(s). Efeitos de interação <strong>não são aditivos</strong> pois podem ser quebrados em dois efeitos distintos e únicos que estão influenciando a variável dependente. <strong>Há uma interação entre as variáveis independentes</strong>.</li>
</ul>
<p>Veja na figura <a href="#fig:mtcars-interaction">5</a> uma representação gráfica da interação entre <code>am</code> e <code>cyl</code>. Note que a interação é observada pela diferença de inclinações entre as linhas coloridas que representam os diferentes valores de <code>cyl</code><a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>mtcars</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span><span class='fu'>across</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>am</span>, <span class='va'>cyl</span><span class='op'>)</span>, <span class='va'>as.factor</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>am</span>, <span class='va'>cyl</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>summarise</span><span class='op'>(</span>mpg <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>mpg</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>am</span>, y <span class='op'>=</span> <span class='va'>mpg</span>, color <span class='op'>=</span> <span class='va'>cyl</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_line</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>group <span class='op'>=</span> <span class='va'>cyl</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_point</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_colour_brewer</span><span class='op'>(</span>palette <span class='op'>=</span> <span class='st'>"Set1"</span><span class='op'>)</span>
</code></pre>
</div>
<div class="figure" style="text-align: center"><span id="fig:mtcars-interaction"></span>
<img src="6-Regressao_Linear_files/figure-html5/mtcars-interaction-1.png" alt="Interação entre `am` e `cyl` do *dataset* `mtcars`" width="70%" />
<p class="caption">
Figure 5: Interação entre <code>am</code> e <code>cyl</code> do <em>dataset</em> <code>mtcars</code>
</p>
</div>
</div>
<p>Para incluirmos efeitos de interações entre duas variáveis independentes em regressões lineares, incluímos na fórmula entre as duas variáveis um sinal de multiplicação[^Matematicamente falando <em>interação</em> é uma <em>multiplicação</em> entre as duas variáveis independentes] <code>*</code> indicando que as duas variáveis devem ser usadas como efeitos principais e também de interação na análise.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>modelo_interacao</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>mpg</span> <span class='op'>~</span> <span class='va'>hp</span> <span class='op'>+</span> <span class='va'>wt</span> <span class='op'>+</span> <span class='va'>cyl</span><span class='op'>*</span><span class='va'>am</span>, data <span class='op'>=</span> <span class='va'>mtcars</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>modelo_interacao</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Call:
lm(formula = mpg ~ hp + wt + cyl * am, data = mtcars)

Residuals:
   Min     1Q Median     3Q    Max 
-4.080 -1.481 -0.769  1.368  5.240 

Coefficients:
            Estimate Std. Error t value       Pr(&gt;|t|)    
(Intercept)  34.6530     3.2428   10.69 0.000000000052 ***
hp           -0.0164     0.0148   -1.11          0.278    
wt           -2.7220     0.9090   -2.99          0.006 ** 
cyl          -0.6646     0.5764   -1.15          0.259    
am            6.3264     3.8041    1.66          0.108    
cyl:am       -0.9000     0.6552   -1.37          0.181    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 2.5 on 26 degrees of freedom
Multiple R-squared:  0.859, Adjusted R-squared:  0.832 
F-statistic: 31.7 on 5 and 26 DF,  p-value: 0.000000000279</code></pre>
</div>
<p>A interpretação do coeficiente <code>cyl:am</code> é a seguinte: <code>cyl</code> (ou <code>am</code>) <strong>modera positivamente</strong> a relação entre <code>am</code> (ou <code>cyl</code>) e <code>mpg</code>. Note que o <span class="math inline">\(p\)</span>-valor de <code>cyl:am</code> não significância estatística (<span class="math inline">\(p = 0.181\)</span>).</p>
<h3 id="efeitos-não-lineares">Efeitos Não-Lineares</h3>
<p>Podemos também incluir efeitos não-lineares em modelos de regressão linear. Uma <strong>relação não-linear é aquela que a representação entre as variáveis não pode ser representada de maneira fidedigna de maneira linear (com uma reta, mas sim com uma curva)</strong>. Na ciência, há diversos fenômenos que não podem ser representados linearmente. Na figura @(fig:mtcars-poly) é possível ver a relação entre <code>hp</code> e <code>mpg</code>: a linha vermelha mostra uma tendência linear e a linha azul uma tendência não-linear.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>mtcars</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>hp</span>, <span class='va'>mpg</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_point</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_smooth</span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"lm"</span>, se <span class='op'>=</span> <span class='cn'>FALSE</span>, color <span class='op'>=</span> <span class='st'>"Red"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_smooth</span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"lm"</span>, formula <span class='op'>=</span> <span class='va'>y</span> <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/stats/poly.html'>poly</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='fl'>2</span><span class='op'>)</span>, se <span class='op'>=</span> <span class='cn'>FALSE</span>, color <span class='op'>=</span> <span class='st'>"Blue"</span><span class='op'>)</span>
</code></pre>
</div>
<div class="figure" style="text-align: center"><span id="fig:mtcars-poly"></span>
<img src="6-Regressao_Linear_files/figure-html5/mtcars-poly-1.png" alt="Relação Não-Linear entre `hp` e `mpg` do *dataset* `mtcars`" width="70%" />
<p class="caption">
Figure 6: Relação Não-Linear entre <code>hp</code> e <code>mpg</code> do <em>dataset</em> <code>mtcars</code>
</p>
</div>
</div>
<p>Para inserirmos efeitos não-lineares, incluímos na fórmula a função <code>poly()</code> com as variáveis que desejamos efeitos não-linares. A função <code>poly()</code> gera polinômios das variáveis conforme o grau especificado. No nosso exemplo abaixo, usaremos um polynômio de grau 2 (efeito quadrático).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>modelo_naolinear</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>mpg</span> <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/stats/poly.html'>poly</a></span><span class='op'>(</span><span class='va'>hp</span>, <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>wt</span>, data <span class='op'>=</span> <span class='va'>mtcars</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>modelo_naolinear</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Call:
lm(formula = mpg ~ poly(hp, 2) + wt, data = mtcars)

Residuals:
   Min     1Q Median     3Q    Max 
-3.059 -1.260 -0.509  0.703  4.980 

Coefficients:
             Estimate Std. Error t value          Pr(&gt;|t|)    
(Intercept)    29.839      2.209   13.51 0.000000000000087 ***
poly(hp, 2)1  -15.172      3.398   -4.46           0.00012 ***
poly(hp, 2)2    6.900      2.763    2.50           0.01867 *  
wt             -3.030      0.674   -4.50           0.00011 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 2.4 on 28 degrees of freedom
Multiple R-squared:  0.858, Adjusted R-squared:  0.843 
F-statistic: 56.6 on 3 and 28 DF,  p-value: 0.00000000000529</code></pre>
</div>
<p>Veja que ambos os coeficientes <code>poly(hp, 2)1</code> (que deve ser interpretado como <span class="math inline">\(\text{hp}^1\)</span>) e <code>poly(hp, 2)2</code> (que deve ser interpretado como <span class="math inline">\(\text{hp}^2\)</span>) possuem significância estatística (<span class="math inline">\(p &lt; 0.05\)</span>).</p>
<h3 id="visualização-de-regressão-linear">Visualização de Regressão Linear</h3>
<p>Uma vez que as variáveis dos modelos de regressão começam a ficar numerosas, as visualizações podem ajudar. Em especial, gostamos bastante da biblioteca <code>{sjPlot}</code> <span class="citation" data-cites="sjPlot">(<a href="#ref-sjPlot" role="doc-biblioref">Lüdecke, 2020</a>)</span> e sua função <code>plot_model()</code>. Como padrão, a função <code>plot_model()</code> produz um gráfico de floresta (<em>forest plot</em>) e também conhecido como blobograma no qual podemos visualizar as variáveis no eixo vertical e o tamanho do efeito, os coeficientes, no eixo horizontal. Além disso, coeficientes positivos são representados com a cor azul e negativos em vermelho; e os intervalos de confiança 95% como uma linha ao redor do valor médio do coeficiente (ponto). Ao especificarmos o tipo como <code>"std"</code> em <code>plot_model()</code>, o gráfico de floresta produzido utiliza os valores padronizados em desvios padrões. Veja um exemplo na figura <a href="#fig:sjPlot">7</a>: no lado esquerdo temos o gráfico de floresta para coeficientes brutos e no lado direto para coeficientes padrões.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://strengejacke.github.io/sjPlot/'>sjPlot</a></span><span class='op'>)</span>
<span class='va'>forest_raw</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://strengejacke.github.io/sjPlot/reference/plot_model.html'>plot_model</a></span><span class='op'>(</span><span class='va'>modelo_quali</span><span class='op'>)</span>
<span class='va'>forest_std</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://strengejacke.github.io/sjPlot/reference/plot_model.html'>plot_model</a></span><span class='op'>(</span><span class='va'>modelo_quali</span>, type <span class='op'>=</span> <span class='st'>"std"</span><span class='op'>)</span>
<span class='va'>forest_raw</span> <span class='op'>+</span> <span class='va'>forest_std</span> <span class='op'>+</span> <span class='fu'>plot_layout</span><span class='op'>(</span>nrow <span class='op'>=</span> <span class='fl'>1</span>, widths <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<div class="figure" style="text-align: center"><span id="fig:sjPlot"></span>
<img src="6-Regressao_Linear_files/figure-html5/sjPlot-1.png" alt="Gráfico de Floresta dos Coeficientes de uma Regressão Linear" width="70%" />
<p class="caption">
Figure 7: Gráfico de Floresta dos Coeficientes de uma Regressão Linear
</p>
</div>
</div>
<p>Caso queira mais opções de visualizações para modelos de regressão não deixe de conferir o <a href="https://strengejacke.github.io/sjPlot/">site da biblioteca <code>{sfPlot}</code></a>.</p>
<h3 id="verificação-de-pressupostos">Verificação de Pressupostos</h3>
<p><strong>A verificação de pressupostos se divide em visualizações e testes estatísticos</strong>.</p>
<h4 id="visualizações">Visualizações</h4>
<p>Para as visualizações diagnóstica de modelos de regressão linear temos a opção <code>plot()</code> padrão do R para modelos <code>lm</code>. Mas essa visualização não é interessante pois usa o sistema padrão do R para visualizações ao invés do sistema <code>{ggplot2}</code> <span class="citation" data-cites="ggplot2">(<a href="#ref-ggplot2" role="doc-biblioref">Wickham, 2016</a>)</span> que permite maiores configurações e controle. Para visualizar diagnósticos de objetos <code>lm</code> usando o sistema <code>{ggplot2}</code> recomendamos a biblioteca <code>{ggfortify}</code> <span class="citation" data-cites="ggfortify">(<a href="#ref-ggfortify" role="doc-biblioref">Horikoshi &amp; Tang, 2018</a>)</span>.</p>
<p>A a função <code>autoplot()</code> da biblioteca <code>{ggfortify}</code> mostra os resíduos em quatro gráficos diferentes:</p>
<ol type="1">
<li><strong><em>Residuals vs Fitted</em> (Resíduos vs Valores Previstos)</strong>: utilizado para verificar os pressupostos de linearidade. Uma linha horizontal, sem padrões distintos é um indicativo de uma relação linear, o que indica que o pressuposto não foi violado.</li>
<li><strong><em>Normal Q-Q</em> (Q-Q dos Resíduos)</strong>: utilizado para verificar se os resíduos estão normalmente distribuídos. Se os pontos residuais seguirem a linha reta tracejada, indica que o pressuposto de independência dos resíduos não foi violado.</li>
<li><strong><em>Scale-Location</em> (Resíduos “Studentizados” vs Valores Previstos)</strong>: utilizado para verificar a homogeneidade da variância dos resíduos (homocedasticidade). Uma linha horizontal com pontos igualmente espalhados é uma boa indicação que o pressuposto não foi violado. Usa o formato “Studentizado” dos resíduos que é o quociente resultante da divisão de um resíduo por uma estimativa de seu desvio padrão. É uma forma de estatística <span class="math inline">\(t\)</span> de Student, com a estimativa de erro variando entre os pontos.</li>
<li><strong><em>Residuals vs Leverage</em> (Resíduos vs Influências)</strong>: Utilizado para identificar casos influentes, ou seja, valores extremos que podem influenciar os resultados da regressão quando incluídos ou excluídos da análise.</li>
</ol>
<p>Veja um exemplo de visualização diagnóstica do <code>modelo_simples</code> na figura <a href="#fig:ggfortify">8</a>. É um bom exemplo que demonstra diversas patologias (problemas) do modelo. Os resíduos (gráfico superior esquerdo) possui um padrão evidente, o gráfico Q-Q dos resíduos (gráfico superior direito) evidencia algumas observações com resíduos que ferem o pressuposto de independência dos resíduos, e por fim possuímos uma observação extremamente influente (gráfico inferior direito – Maserati B) que talvez prejudique as inferências do modelo.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/sinhrks/ggfortify'>ggfortify</a></span><span class='op'>)</span>
<span class='fu'>autoplot</span><span class='op'>(</span><span class='va'>modelo_simples</span><span class='op'>)</span>
</code></pre>
</div>
<div class="figure" style="text-align: center"><span id="fig:ggfortify"></span>
<img src="6-Regressao_Linear_files/figure-html5/ggfortify-1.png" alt="Diagnósticos de Regressão Linear" width="100%" />
<p class="caption">
Figure 8: Diagnósticos de Regressão Linear
</p>
</div>
</div>
<h4 id="testes-estatísticos">Testes Estatísticos</h4>
<p>Além de visualizações diagnóstica, podemos realizar diversos testes estatísticos de hipótese nula para verificar se o modelo de regressão linear possui pressupostos violados ou não. Para isso recomendamos a biblioteca <code>{lmtest}</code> <span class="citation" data-cites="lmtest">(<a href="#ref-lmtest" role="doc-biblioref">Zeileis &amp; Hothorn, 2002</a>)</span>.</p>
<h5 id="teste-de-breusch-pagan">Teste de Breusch-Pagan</h5>
<p>O <strong>teste de Breusch-Pagan<span class="citation" data-cites="breusch1979simple cook1983diagnostics">(<a href="#ref-breusch1979simple" role="doc-biblioref">Breusch &amp; Pagan, 1979</a>; <a href="#ref-cook1983diagnostics" role="doc-biblioref">Cook &amp; Weisberg, 1983</a>)</span> usado para testar o pressuposto da independência dos resíduos</strong> possui como hipótese nula que “as variâncias de erro são todas iguais” e como hipótese alternativa que “as variâncias de erro são uma função multiplicativa de uma ou mais variáveis.” Recomendamos que usem os resíduos “Studentizados” (quociente resultante da divisão de um resíduo por uma estimativa de seu desvio padrão – uma forma de estatística <span class="math inline">\(t\)</span> de Student, com a estimativa de erro variando entre os pontos) no teste de Breusch-Pagan <span class="citation" data-cites="koenker1981note">(<a href="#ref-koenker1981note" role="doc-biblioref">Koenker, 1981</a>)</span>. A função <code>bptest()</code> da biblioteca <code>{lmtest}</code> aceita como argumento um modelo de regressão linear (objeto <code>lm</code>) e já possui como padrão resíduos “Studentizados.” Caso queira usar resíduos brutos indique o argumento <code>studentize</code> como <code>FALSE</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>lmtest</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/lmtest/man/bptest.html'>bptest</a></span><span class='op'>(</span><span class='va'>modelo_simples</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
    studentized Breusch-Pagan test

data:  modelo_simples
BP = 0.9, df = 2, p-value = 0.6</code></pre>
</div>
<p>Note que o <span class="math inline">\(p\)</span>-valor do Teste de Breusch-Pagan para o <code>modelo_simples</code> é 0.6, demonstrando fortes evidências que os resíduos são independentes.</p>
<h5 id="teste-de-durbin-watson">Teste de Durbin-Watson</h5>
<p>O <strong>teste de Durbin-Watson <span class="citation" data-cites="durbin1950testing durbin1951testing">(<a href="#ref-durbin1950testing" role="doc-biblioref">Durbin &amp; Watson, 1950</a>, <a href="#ref-durbin1951testing" role="doc-biblioref">1951</a>)</span> é um teste estatístico usado para detectar a presença de autocorrelação dos resíduos de um modelo de regressão e testa o pressuposto da homogeneidade de variância dos resíduos</strong>. Possui como hipótese nula que os “erros são serialmente não correlacionados.” A função <code>dwtest()</code> da biblioteca <code>{lmtest}</code> aceita como argumento um modelo de regressão linear (objeto <code>lm</code>).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='fu'><a href='https://rdrr.io/pkg/lmtest/man/dwtest.html'>dwtest</a></span><span class='op'>(</span><span class='va'>modelo_simples</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
    Durbin-Watson test

data:  modelo_simples
DW = 1, p-value = 0.02
alternative hypothesis: true autocorrelation is greater than 0</code></pre>
</div>
<p>Note que o <span class="math inline">\(p\)</span>-valor do Teste de Durbin-Watson para o <code>modelo_simples</code> é 0.02, demonstrando fortes evidências que os resíduos são correlacionados entre si, violando o pressuposto da homogeneidade de variância dos resíduos.</p>
<h5 id="multicolinearidade">Multicolinearidade</h5>
<p><strong>Multicolinearidade é a ocorrência de alta correlação entre duas ou mais variáveis independentes e pode levar a resultados distorcidos</strong>. Em geral, a multicolinearidade pode fazer com que os intervalos de confiança se ampliem, ou até mudar o sinal de influência das variáveis independentes (de positivo para negativo, por exemplo). Portanto, as inferências estatísticas de uma regressão com multicolinearidade não são confiáveis. Pode ser testado usando o <strong>Fator de Inflação de Variância (<em>Variance Inflation Factor</em> – VIF)</strong>.</p>
<p>Os VIFs medem o quanto da variância de cada coeficiente de regressão do modelo estatístico se encontra inflado em relação à situação em que as variáveis independentes não estão correlacionadas. Valores aceitáveis de VIF são menores que 10 <span class="citation" data-cites="hair1998multivariate">(<a href="#ref-hair1998multivariate" role="doc-biblioref">Hair et al., 1998</a>)</span>. Para calcular os VIFs de uma modelo <code>lm</code> use a função <code>vif()</code> da biblioteca <code>{car}</code> <span class="citation" data-cites="car">(<a href="#ref-car" role="doc-biblioref">Fox &amp; Weisberg, 2019</a>)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://r-forge.r-project.org/projects/car/'>car</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/car/man/vif.html'>vif</a></span><span class='op'>(</span><span class='va'>modelo_simples</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> hp  wt 
1.8 1.8 </code></pre>
</div>
<p>Note que os valores de VIFs para as variáveis independentes do <code>modelo_simples</code> estão todos dentro do limite aceitável (<span class="math inline">\(&lt;10\)</span>), demonstrando ausência de multicolinearidade e evidenciando que o pressuposto não foi violado.</p>
<h2 id="r2-e-r2-ajustado"><span class="math inline">\(R^2\)</span> e <span class="math inline">\(R^2\)</span> ajustado</h2>
<p>O leitor curioso e atencioso talvez tenha percebido que não comentamos uma métrica dos modelos de regressão: R-quadrado (<span class="math inline">\(R^2\)</span>) e R-quadrado ajustado (<span class="math inline">\(R^2\)</span> ajustado).</p>
<p>O <span class="math inline">\(R^2\)</span> também conhecido como <strong>coeficiente de determinação representa a proporção da variabilidade na variável dependente prevista<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a> pelas variável independentes</strong>. É uma métrica que <strong>quantifica o poder preditivo de um modelo de regressão</strong>.</p>
<p>Já o <span class="math inline">\(R^2\)</span> ajustado inclui uma pequena <strong>penalidade pelo número de variáveis independentes usada no modelo de regressão</strong>. Conforme você adiciona variáveis independentes à um modelo de regressão, o seu <span class="math inline">\(R^2\)</span> sempre aumentará, mas o <span class="math inline">\(R^2\)</span> ajustado somente aumentará se você adicionar <strong>variáveis independentes úteis ao modelo</strong> (variáveis que aumentem o <span class="math inline">\(R^2\)</span> um valor maior que a penalidade pela sua inclusão).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>modelo_simples</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Call:
lm(formula = mpg ~ hp + wt, data = mtcars)

Residuals:
   Min     1Q Median     3Q    Max 
-3.941 -1.600 -0.182  1.050  5.854 

Coefficients:
            Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept) 37.22727    1.59879   23.28 &lt; 0.0000000000000002 ***
hp          -0.03177    0.00903   -3.52               0.0015 ** 
wt          -3.87783    0.63273   -6.13            0.0000011 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 2.6 on 29 degrees of freedom
Multiple R-squared:  0.827, Adjusted R-squared:  0.815 
F-statistic: 69.2 on 2 and 29 DF,  p-value: 0.00000000000911</code></pre>
</div>
<p>Veja que o <code>modelo_simples</code> possui como <span class="math inline">\(R^2\)</span> um valor de 0.83: isto quer dizer que o <code>modelo_simples</code> possui um poder preditivo de 83% da variância de <code>mpg</code>. Além disso seu <span class="math inline">\(R^2\)</span> ajustado é que pode ser útil na hora de comparar diferentes modelos que usem o mesmo conjunto de dados <code>mtcars</code> e a mesma variável dependente <code>mpg</code>.</p>
<h2 id="coeficientes-brutos-versus-padronizados">Coeficientes Brutos versus Padronizados</h2>
<p>Além de coeficientes brutos, podemos também obter coeficientes padronizados por desvios padrões de regressão linear usando a biblioteca <code>{lm.beta}</code> <span class="citation" data-cites="lmbeta">(<a href="#ref-lmbeta" role="doc-biblioref">Behrendt, 2014</a>)</span>. Tal interpretação é vantajosa quando temos variáveis na regressão que possuem medidas diversas e que a comparação não seria tão simples. Os coeficientes padronizados são disponibilizados na coluna <code>Standardized</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>lm.beta</span><span class='op'>)</span>
<span class='va'>modelo_simples_padronizado</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/lm.beta/man/lm.beta.html'>lm.beta</a></span><span class='op'>(</span><span class='va'>modelo_simples</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>modelo_simples_padronizado</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Call:
lm(formula = mpg ~ hp + wt, data = mtcars)

Residuals:
   Min     1Q Median     3Q    Max 
-3.941 -1.600 -0.182  1.050  5.854 

Coefficients:
            Estimate Standardized Std. Error t value
(Intercept) 37.22727      0.00000    1.59879   23.28
hp          -0.03177     -0.36145    0.00903   -3.52
wt          -3.87783     -0.62955    0.63273   -6.13
                        Pr(&gt;|t|)    
(Intercept) &lt; 0.0000000000000002 ***
hp                        0.0015 ** 
wt                     0.0000011 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 2.6 on 29 degrees of freedom
Multiple R-squared:  0.827, Adjusted R-squared:  0.815 
F-statistic: 69.2 on 2 and 29 DF,  p-value: 0.00000000000911</code></pre>
</div>
<p>A interpretação de coeficientes padronizados é quase a mesma que coeficientes padrões, apenas mudando a escala de comparação, que deve ser interpretada em <strong>escala padronizada em desvios padrões</strong>: <strong>o acréscimo de 1 unidade de desvio padrão variável independente gera o aumento de <code>&lt;coeficiente&gt;</code> unidade(s) de desvio padrão(ões) da variável dependente</strong>. No nosso exemplo, a cada acréscimo de 1 desvio padrão de <code>hp</code>, <code>mpg</code> reduz em -0.36 desvio padrão; e a cada acréscimo de 1 desvio padrão <code>wt</code>, <code>mpg</code> reduz em -0.63 desvio padrão.</p>
<p>Note que a constante <code>(Intercept)</code> não deve ser usada em escalas padronizada por desvio padrão, por isso que a saída de objetos <code>lm.beta</code> possui valor 0 para a constante <code>(Intercept)</code>.</p>
<p>Para gerar intervalos de confiança podemos usar a função <code>confint()</code> para objetos <code>lm.beta</code> da mesma maneira que usamos para objetos <code>lm</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>modelo_simples_padronizado</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>            2.5 % 97.5 %
(Intercept) -3.27   3.27
hp          -0.38  -0.34
wt          -1.92   0.66</code></pre>
</div>
<h2 id="conexões-com-o-teste-t-anova-e-correlações">Conexões com o Teste <span class="math inline">\(t\)</span>, ANOVA e Correlações</h2>
<div class="layout-chunk" data-layout="l-body">
<p><img src="images/meme-regressao-scooby.jpg" width="70%" style="display: block; margin: auto;" /></p>
</div>
<p>Todos as técnicas estatísticas que vimos até agora (teste <span class="math inline">\(t\)</span>, ANOVA e correlação) são casos especiais de regressão linear<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a>. Caso o leitor se interesse aconselhamos a leitura do capítulo 5 de <span class="citation" data-cites="poldrack2018"><a href="#ref-poldrack2018" role="doc-biblioref">Poldrack</a> (<a href="#ref-poldrack2018" role="doc-biblioref">2018</a>)</span> e o excelente tutorial de <span class="citation" data-cites="lindelov2019"><a href="#ref-lindelov2019" role="doc-biblioref">Lindelov</a> (<a href="#ref-lindelov2019" role="doc-biblioref">2019</a>)</span>. Caso o leitor queira substituir todos os testes estatísticos pela função <code>lm()</code> veja a tabela abaixo:</p>
<aside>
Conforme o autor 2, regressão linear é pizza e “tudo acaba em pizza.”
</aside>
<div class="layout-chunk" data-layout="l-body">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#ikksjwbyft .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ikksjwbyft .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ikksjwbyft .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ikksjwbyft .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ikksjwbyft .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ikksjwbyft .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ikksjwbyft .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ikksjwbyft .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ikksjwbyft .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ikksjwbyft .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ikksjwbyft .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ikksjwbyft .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#ikksjwbyft .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ikksjwbyft .gt_from_md > :first-child {
  margin-top: 0;
}

#ikksjwbyft .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ikksjwbyft .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ikksjwbyft .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#ikksjwbyft .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ikksjwbyft .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#ikksjwbyft .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ikksjwbyft .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ikksjwbyft .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ikksjwbyft .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ikksjwbyft .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ikksjwbyft .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#ikksjwbyft .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ikksjwbyft .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#ikksjwbyft .gt_left {
  text-align: left;
}

#ikksjwbyft .gt_center {
  text-align: center;
}

#ikksjwbyft .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ikksjwbyft .gt_font_normal {
  font-weight: normal;
}

#ikksjwbyft .gt_font_bold {
  font-weight: bold;
}

#ikksjwbyft .gt_font_italic {
  font-style: italic;
}

#ikksjwbyft .gt_super {
  font-size: 65%;
}

#ikksjwbyft .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="ikksjwbyft" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Nome do Teste<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">função do R</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Modelo de Regressão equivalente no R</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">P: teste t para Amostras Independentes</td>
      <td class="gt_row gt_left">t.test(y)</td>
      <td class="gt_row gt_left">lm(y ~ 1)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">N: Teste de Wilcoxon</td>
      <td class="gt_row gt_left">wilcox.test(y)</td>
      <td class="gt_row gt_left">lm(signed_rank(y) ~ 1)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">P: Teste t para duas Amostras Pareadas</td>
      <td class="gt_row gt_left">t.test(y1, y2, paired=TRUE)</td>
      <td class="gt_row gt_left">lm(y2 - y1 ~ 1)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">N: Teste de Wilcoxon para duas Amostras Pareadaspairs</td>
      <td class="gt_row gt_left">wilcox.test(y1, y2, paired=TRUE)</td>
      <td class="gt_row gt_left">lm(signed_rank(y2 - y1) ~ 1)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">P: Correlação de Pearson</td>
      <td class="gt_row gt_left">cor.test(x, y, method=’Pearson’)</td>
      <td class="gt_row gt_left">lm(y ~ 1 + x)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">N: Correlação de Spearman</td>
      <td class="gt_row gt_left">cor.test(x, y, method=’Spearman’)</td>
      <td class="gt_row gt_left">lm(rank(y) ~ 1 + rank(x))</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">P: Teste t para Duas Amostras não-Pareadas</td>
      <td class="gt_row gt_left">t.test(y1, y2, var.equal=TRUE)</td>
      <td class="gt_row gt_left">lm(y ~ 1 + G2)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">N: Teste de Mann-Whitney</td>
      <td class="gt_row gt_left">wilcox.test(y1, y2)</td>
      <td class="gt_row gt_left">lm(signed_rank(y) ~ 1 + G2)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">P: ANOVA Unidirecional</td>
      <td class="gt_row gt_left">aov(y ~ group)</td>
      <td class="gt_row gt_left">lm(y ~ 1 + G2 + G3 +…+ GN)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">N: Teste de Kruskal-Wallis</td>
      <td class="gt_row gt_left">kruskal.test(y ~ group)</td>
      <td class="gt_row gt_left">lm(rank(y) ~ 1 + G2 + G3 +…+ GN)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">P: ANOVA Bidirecional com efeitos principais</td>
      <td class="gt_row gt_left">aov(y ~ group + x)</td>
      <td class="gt_row gt_left">lm(y ~ 1 + G2 + G3 +…+ GN + x)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">P: ANOVA Bidirecional com efeitos de interação</td>
      <td class="gt_row gt_left">aov(y ~ group * sex)</td>
      <td class="gt_row gt_left">lm(y ~ 1 + G2 + G3 +…+ GN + S2 + S3 +…+ SK + G2*S2 + G3*S3 + … + GN*SK)</td>
    </tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" colspan="3">Fonte: adaptado de Lindelov (2019).</td>
    </tr>
  </tfoot>
  <tfoot>
    <tr class="gt_footnotes">
      <td colspan="3">
        <p class="gt_footnote">
          <sup class="gt_footnote_marks">
            <em>1</em>
          </sup>
           
          <strong>P</strong>: paramétrico - <strong>N</strong>: não-paramétrico
          <br />
        </p>
      </td>
    </tr>
  </tfoot>
</table></div>
</div>
<h2 id="técnicas-avançadas-de-regressão-linear">Técnicas Avançadas de Regressão Linear</h2>
<p>Nesta seção apenas apresentaremos alternativas, não é o foco desse conteúdo introdutório apresentar de maneira detalhada, mas sim de apontar o leitor na direção correta.</p>
<ul>
<li><strong>Regressão Robusta</strong></li>
<li><strong>Regressão Regularizada</strong></li>
<li><strong>Regressão Aditiva - Modelos Aditivos Generalizados</strong></li>
<li><strong>Regressão Multinível</strong></li>
</ul>
<h3 id="regressão-robusta">Regressão Robusta</h3>
<p>Regressão linear não é uma boa alternativa na presença de observações extremas (também chamadas de <em>outliers</em>). O pressuposto de que os erros (ou resíduos) são distribuidos conforme uma distribuição Normal com média 0 faz com que as estimativas de uma regressão linear fiquem instáveis. Para exemplificar isso, vamos fazer uma simulação com 50 observações sendo que 40 observações são distribuídas como uma distribuição Normal e 10 observações são extremas (estão além de dois desvios padrões – <span class="math inline">\(\pm 2 \times \sigma\)</span>).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>

<span class='va'>n_sims</span> <span class='op'>&lt;-</span> <span class='fl'>50</span>

<span class='va'>sims</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>
  x <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='va'>n_sims</span>,
  y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>floor</a></span><span class='op'>(</span><span class='fl'>4</span> <span class='op'>*</span> <span class='va'>n_sims</span><span class='op'>/</span><span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>4</span><span class='op'>:</span><span class='op'>-</span><span class='fl'>3</span>, <span class='fl'>3</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>ceiling</a></span><span class='op'>(</span><span class='va'>n_sims</span><span class='op'>/</span><span class='fl'>5</span><span class='op'>)</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>,
  tipo <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"normal"</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>floor</a></span><span class='op'>(</span><span class='fl'>4</span> <span class='op'>*</span> <span class='va'>n_sims</span><span class='op'>/</span><span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"extrema"</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>ceiling</a></span><span class='op'>(</span><span class='va'>n_sims</span><span class='op'>/</span><span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/sample_n.html'>sample_frac</a></span><span class='op'>(</span><span class='fl'>1L</span><span class='op'>)</span>  <span class='co'>## Randomize!</span>
</code></pre>
</div>
</div>
<p>A figura <a href="#fig:plot-simul-linear-reg">9</a> mostra um diagrama de pontos (<em>dotplot</em>) da simulação e duas distribuições estimadas com os dados: Normal e <span class="math inline">\(t\)</span> de Student (graus de liberdade = 3). Devido às observações extremas, a distribuição Normal, para comportar todas as observações, se alarga e achata. Tal achatamento e alargamento não ocorrem na distribuição <span class="math inline">\(t\)</span> de Student. Isto se traduz em estimativas mais estáveis dos coeficientes da regressão na presença de observações extremas. Por esses motivos, para nós, a melhor a maneira de aplicar um modelo de regressão na presença de observações extremas é por meio de Estatística Bayesiana usando uma distribuição <span class="math inline">\(t\)</span> de Student como o “motor” de inferência.</p>
<aside>
O primeiro autor possui um tutorial de <a href="https://storopoli.github.io/Estatistica-Bayesiana/">Estatística Bayesiana com R</a> e uma das aulas é sobre <a href="https://storopoli.github.io/Estatistica-Bayesiana/8-Regressao_Robusta.html">regressão robusta usando distribuição <span class="math inline">\(t\)</span> de Student</a>.
</aside>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>
<span class='va'>sims</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>y</span>, fill <span class='op'>=</span> <span class='va'>tipo</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_dotplot.html'>geom_dotplot</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_function.html'>stat_function</a></span><span class='op'>(</span>fun <span class='op'>=</span> <span class='va'>dnorm</span>,
                args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mean <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>sims</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span>, sd <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>sims</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span><span class='op'>)</span>,
                <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"Distribuição\nNormal"</span><span class='op'>)</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_function.html'>stat_function</a></span><span class='op'>(</span>fun <span class='op'>=</span> <span class='va'>dt</span>,
                args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>df <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>,
                <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"Distribuição t\nde Student"</span><span class='op'>)</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_brewer.html'>scale_fill_brewer</a></span><span class='op'>(</span><span class='st'>"Tipo de Observação"</span>, palette <span class='op'>=</span> <span class='st'>"Set1"</span>,
                    guide <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guide_legend.html'>guide_legend</a></span><span class='op'>(</span>ncol <span class='op'>=</span> <span class='fl'>1</span>, nrow <span class='op'>=</span> <span class='fl'>2</span>, byrow <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_brewer.html'>scale_colour_brewer</a></span><span class='op'>(</span><span class='st'>"Tipo de Distribuição"</span>, palette <span class='op'>=</span> <span class='st'>"Set3"</span>,
                      guide <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guide_legend.html'>guide_legend</a></span><span class='op'>(</span>ncol <span class='op'>=</span> <span class='fl'>1</span>, nrow <span class='op'>=</span> <span class='fl'>2</span>, byrow <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"bottom"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>ylim</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.4</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<div class="figure" style="text-align: center"><span id="fig:plot-simul-linear-reg"></span>
<img src="6-Regressao_Linear_files/figure-html5/plot-simul-linear-reg-1.png" alt="Simulação com Observações Normais e Extremas -- Distribuição Normal vs t de Student" width="70%" />
<p class="caption">
Figure 9: Simulação com Observações Normais e Extremas – Distribuição Normal vs t de Student
</p>
</div>
</div>
<p>Caso o leitor não queria sair do paradigma NHST (afinal em Estatística Bayesiana não temos <span class="math inline">\(H_0\)</span> nem <span class="math inline">\(p\)</span>-valores), há duas alternativas de <a href="https://en.wikipedia.org/wiki/Robust_regression">regressão robusta</a>:</p>
<ol type="1">
<li><strong>M-estimação</strong><a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a> <span class="citation" data-cites="huber1964">(<a href="#ref-huber1964" role="doc-biblioref">Huber, 1964</a>)</span>: robusta à observações extremas na variável dependentes, mas não nas independentes.</li>
<li><strong>Mínimos quadrados aparados</strong><a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a> <span class="citation" data-cites="rousseeuw1984least">(<a href="#ref-rousseeuw1984least" role="doc-biblioref">Rousseeuw, 1984</a>)</span>: robusto tanto à observações extremas na variável dependente quanto nas independentes. O método recomendado atualmente por diversas fontes <span class="citation" data-cites="ryan2008modern rousseeuw2006computing">(<a href="#ref-rousseeuw2006computing" role="doc-biblioref">Rousseeuw &amp; Van Driessen, 2006</a>; <a href="#ref-ryan2008modern" role="doc-biblioref">Ryan, 2008</a>)</span></li>
</ol>
<h3 id="regressão-regularizada">Regressão Regularizada</h3>
<p>Regularized regression is a type of regression where the coefficient estimates are constrained to zero. The magnitude (size) of coefficients, as well as the magnitude of the error term, are penalized. Complex models are discouraged, primarily to avoid overfitting.</p>
<p>“Regularization” is a way to give a penalty to certain models (usually overly complex ones). Ridge regression belongs to the set of L2 regularization tools. L2 regularization adds a penalty called an L2 penalty, which is the same as the square of the magnitude of coefficients. All coefficients are shrunk by the same factor, so all the coefficients remain in the model. The strength of the penalty term is controlled by a tuning parameter. When this tuning parameter (λ) is set to zero, ridge regression equals least squares regression. If λ = ∞, all coefficients are shrunk to zero. The ideal penalty is therefore somewhere in between 0 and ∞. The other type of regularization, L1 regularization, limits the size of the coefficients by adding an L1 penalty equal to the absolute value of the magnitude of coefficients. This sometimes results in the elimination of some coefficients altogether, which can result in sparse models.</p>
<p>A regressão regularizada é um tipo de regressão em que as estimativas dos coeficientes são restritas a zero. A magnitude (tamanho) dos coeficientes, bem como a magnitude do termo de erro, são penalizados. Modelos complexos são desencorajados, principalmente para evitar <em>overfitting</em>.</p>
<h4 id="tipos-de-regressão-regularizada">Tipos de regressão regularizada</h4>
<p><strong>Dois tipos comumente usados de métodos de regressão regularizados são regressão Ridge e regressão de Lasso</strong>.</p>
<p>A <strong>regressão de Ridge<span class="citation" data-cites="tikhonov1943stability">(<a href="#ref-tikhonov1943stability" role="doc-biblioref">Tikhonov, 1943</a>)</span> é uma forma de criar um modelo parcimonioso quando o número de variáveis preditoras em um conjunto excede o número de observações (<span class="math inline">\(m &gt; p\)</span>) ou quando um conjunto de dados tem forte multicolinearidade (correlações entre variáveis preditoras)</strong>. A regressão Ridge pertence ao conjunto de <strong>ferramentas de regularização L2</strong>. A regularização L2 adiciona uma penalidade chamada penalidade L2, que é igual ao quadrado da magnitude dos coeficientes. Todos os coeficientes são reduzidos pelo mesmo fator, de modo que todos os coeficientes permanecem no modelo. A força do termo de penalidade é controlada por um parâmetro de ajuste. Quando este parâmetro de ajuste (<span class="math inline">\(\lambda\)</span>) é definido como zero, a regressão Ridge é igual à regressão linear. Se <span class="math inline">\(\lambda = \infty\)</span>, todos os coeficientes são reduzidos a zero. A penalidade ideal é, portanto, algo entre <span class="math inline">\(0\)</span> e <span class="math inline">\(\infty\)</span>.</p>
<p>A <strong>regressão Lasso (<em>least absolute shrinkage and selection operator</em> – Lasso) <span class="citation" data-cites="tibshirani1996regression efron2016computer">(<a href="#ref-efron2016computer" role="doc-biblioref">Efron &amp; Hastie, 2016</a>; <a href="#ref-tibshirani1996regression" role="doc-biblioref">Tibshirani, 1996</a>)</span> é um tipo de regressão linear que usa encolhimento (<em>shrinkage</em>)</strong>. Encolhimento faz com os valores dos coeficientes sejam reduzidos em direção a um ponto central, como a média. Este tipo de redução é muito útil quando você tem altos níveis de muticolinearidade ou quando deseja automatizar certas partes da seleção de modelo, como seleção de variável / eliminação de parâmetro. Lasso usa a <strong>regularização L1 que limita o tamanho dos coeficientes adicionando uma penalidade L1 igual ao valor absoluto</strong>, ao invés do valor quadrado como L2, da magnitude dos coeficientes. Isso às vezes resulta na <strong>eliminação de alguns coeficientes completamente</strong>, o que pode resultar em modelos esparsos e seleção de variáveis.</p>
<p>Para usar modelos de regressão regularizada use a biblioteca <code>{glmnet}</code> <span class="citation" data-cites="glmnet">(<a href="#ref-glmnet" role="doc-biblioref">Simon, Friedman, Hastie, &amp; Tibshirani, 2011</a>)</span>.</p>
<h3 id="regressão-aditiva---modelos-aditivos-generalizados">Regressão Aditiva - Modelos Aditivos Generalizados</h3>
<p>Em estatística, um <strong>modelo aditivo generalizado (<em>generalized additive model</em> – GAM) é um modelo linear generalizado no qual a variável de resposta depende linearmente de funções suaves (chamadas de <em>splines</em>) desconhecidas de algumas variáveis preditoras, e o interesse se concentra na inferência sobre essas funções suaves</strong>. Os GAMs foram desenvolvidos originalmente por Trevor Hastie e Robert Tibshirani <span class="citation" data-cites="hastie1986generalized">(<a href="#ref-hastie1986generalized" role="doc-biblioref">Hastie, Tibshirani, &amp; others, 1986</a>)</span>. Para usar GAMs no R use a biblioteca <code>{gam}</code> <span class="citation" data-cites="gam">(<a href="#ref-gam" role="doc-biblioref">Hastie, 2020</a>)</span>.</p>
<h3 id="regressão-multinível">Regressão Multinível</h3>
<p><strong>Modelos multiníveis</strong> (também conhecidos como modelos lineares hierárquicos, modelo linear de efeitos mistos, modelos mistos, modelos de dados aninhados, coeficiente aleatório, modelos de efeitos aleatórios, modelos de parâmetros aleatórios ou designs de gráfico dividido) são <strong>modelos estatísticos de parâmetros que variam em mais de um nível</strong> <span class="citation" data-cites="luke2019multilevel">(<a href="#ref-luke2019multilevel" role="doc-biblioref">Luke, 2019</a>)</span>.</p>
<p>Modelos multiníveis são particularmente apropriados para projetos de pesquisa onde os <strong>dados dos participantes são organizados em mais de um nível</strong> (ou seja, dados aninhados). As unidades de análise geralmente são indivíduos (em um nível inferior) que estão aninhados em unidades contextuais / agregadas (em um nível superior).</p>
<p><strong>Modelos multiníveis geralmente se dividem em três abordagens</strong>:</p>
<ol type="1">
<li><em>Random intercept model</em>: Modelo no qual cada grupo recebe uma constante (<em>intercept</em>) diferente</li>
<li><em>Random slope model</em>: Modelo no qual cada grupo recebe um coeficiente diferente para cada variável independente</li>
<li><em>Random intercept-slope model</em>: Modelo no qual cada grupo recebe tanto uma constante (<em>intercept</em>) quanto um coeficiente diferente para cada variável independente</li>
</ol>
<aside>
O primeiro autor possui um tutorial de <a href="https://storopoli.github.io/Estatistica-Bayesiana/">Estatística Bayesiana com R</a> e uma das aulas é sobre <a href="https://storopoli.github.io/Estatistica-Bayesiana/9-Regressao_Multinivel.html">regressão multinível</a>.
</aside>
<p>Para usar modelos multiníveis em R use a biblioteca <code>{lme4}</code> <span class="citation" data-cites="lme4">(<a href="#ref-lme4" role="doc-biblioref">Bates, Mächler, Bolker, &amp; Walker, 2015</a>)</span>.</p>
<h2 id="comentários-finais">Comentários Finais</h2>
<p><strong>Regressão Linear é a porta de entrada para os modelos lineares</strong>. Tais modelos são o “pão-com-manteiga” das ciências sociais aplicadas, usado extensamente tanto em relatórios técnicos quanto na literatura científica, assim como tanto em contextos profissionais quanto acadêmicos. Acreditamos que <strong>regressão linear é o conteúdo mais importante</strong> (logo atrás de <span class="math inline">\(p\)</span>-valores) desse conjunto de tutoriais. Tal importância se dá por dois fatores. Primeiro, <strong>todas as técnicas estatística que vimos até agora (teste <span class="math inline">\(t\)</span>, ANOVA e correlação) podem ser substituídas por casos especiais de regressão linear</strong>. Segundo, <strong>eles são a base de entendimento para todos os modelos de regressão existentes</strong> (alguns listados na seção de “Técnicas Avançadas”).</p>
<h2 id="ambiente">Ambiente</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='fu'><a href='https://rdrr.io/r/utils/sessionInfo.html'>sessionInfo</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>R version 4.0.3 (2020-10-10)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Big Sur 10.16

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods  
[7] base     

other attached packages:
 [1] gt_0.2.2         lm.beta_1.5-1    car_3.0-10      
 [4] carData_3.0-4    lmtest_0.9-38    zoo_1.8-8       
 [7] ggfortify_0.4.11 sjPlot_2.8.6     skimr_2.1.2     
[10] cowplot_1.1.1    broom_0.7.3      patchwork_1.1.1 
[13] dplyr_1.0.2      ggplot2_3.3.3   

loaded via a namespace (and not attached):
 [1] nlme_3.1-151       insight_0.11.1     RColorBrewer_1.1-2
 [4] repr_1.1.0         tools_4.0.3        backports_1.2.1   
 [7] R6_2.5.0           sjlabelled_1.1.7   mgcv_1.8-33       
[10] colorspace_2.0-0   withr_2.3.0        tidyselect_1.1.0  
[13] gridExtra_2.3      emmeans_1.5.3      downlit_0.2.1     
[16] curl_4.3           compiler_4.0.3     performance_0.6.1 
[19] sandwich_3.0-0     sass_0.2.0         labeling_0.4.2    
[22] bayestestR_0.8.0   checkmate_2.0.0    scales_1.1.1      
[25] mvtnorm_1.1-1      commonmark_1.7     stringr_1.4.0     
[28] digest_0.6.27      foreign_0.8-81     minqa_1.2.4       
[31] rmarkdown_2.6      rio_0.5.16         base64enc_0.1-3   
[34] pkgconfig_2.0.3    htmltools_0.5.0    lme4_1.1-26       
[37] highr_0.8          readxl_1.3.1       rlang_0.4.10      
[40] farver_2.0.3       generics_0.1.0     jsonlite_1.7.2    
[43] zip_2.1.1          distill_1.1        magrittr_2.0.1    
[46] parameters_0.10.1  Matrix_1.3-0       Rcpp_1.0.5        
[49] munsell_0.5.0      fansi_0.4.1        abind_1.4-5       
[52] lifecycle_0.2.0    stringi_1.5.3      multcomp_1.4-15   
[55] yaml_2.2.1         snakecase_0.11.0   MASS_7.3-53       
[58] grid_4.0.3         parallel_4.0.3     sjmisc_2.8.5      
[61] forcats_0.5.0      crayon_1.3.4       lattice_0.20-41   
[64] ggeffects_1.0.1    haven_2.3.1        splines_4.0.3     
[67] sjstats_0.18.0     hms_0.5.3          magick_2.5.2      
[70] knitr_1.30         pillar_1.4.7       boot_1.3-25       
[73] estimability_1.3   effectsize_0.4.1   codetools_0.2-18  
[76] glue_1.4.2         evaluate_0.14      data.table_1.13.6 
[79] modelr_0.1.8       vctrs_0.3.6        nloptr_1.2.2.2    
[82] cellranger_1.1.0   gtable_0.3.0       purrr_0.3.4       
[85] tidyr_1.1.2        openxlsx_4.2.3     xfun_0.19         
[88] xtable_1.8-4       coda_0.19-4        survival_3.2-7    
[91] tibble_3.0.4       statmod_1.4.35     TH.data_1.0-10    
[94] ellipsis_0.3.1    </code></pre>
</div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="doc-bibliography">
<div id="ref-lme4" class="csl-entry" role="doc-biblioentry">
Bates, D., Mächler, M., Bolker, B., &amp; Walker, S. (2015). Fitting linear mixed-effects models using <span class="nocase">lme4</span>. <em>Journal of Statistical Software</em>, <em>67</em>(1), 1–48. <a href="https://doi.org/10.18637/jss.v067.i01">https://doi.org/10.18637/jss.v067.i01</a>
</div>
<div id="ref-lmbeta" class="csl-entry" role="doc-biblioentry">
Behrendt, S. (2014). <em>Lm.beta: Add standardized regression coefficients to lm-objects</em>. Retrieved from <a href="https://CRAN.R-project.org/package=lm.beta">https://CRAN.R-project.org/package=lm.beta</a>
</div>
<div id="ref-breusch1979simple" class="csl-entry" role="doc-biblioentry">
Breusch, T. S., &amp; Pagan, A. R. (1979). A simple test for heteroscedasticity and random coefficient variation. <em>Econometrica: Journal of the Econometric Society</em>, 1287–1294.
</div>
<div id="ref-cook1983diagnostics" class="csl-entry" role="doc-biblioentry">
Cook, R. D., &amp; Weisberg, S. (1983). Diagnostics for heteroscedasticity in regression. <em>Biometrika</em>, <em>70</em>(1), 1–10.
</div>
<div id="ref-durbin1950testing" class="csl-entry" role="doc-biblioentry">
Durbin, J., &amp; Watson, G. S. (1950). Testing for serial correlation in least squares regression: i. <em>Biometrika</em>, <em>37</em>(3/4), 409–428.
</div>
<div id="ref-durbin1951testing" class="csl-entry" role="doc-biblioentry">
Durbin, J., &amp; Watson, G. S. (1951). Testing for serial correlation in least squares regression. II. <em>Biometrika</em>, <em>38</em>(1/2), 159–179.
</div>
<div id="ref-efron2016computer" class="csl-entry" role="doc-biblioentry">
Efron, B., &amp; Hastie, T. (2016). <em>Computer age statistical inference</em> (Vol. 5). Cambridge University Press.
</div>
<div id="ref-car" class="csl-entry" role="doc-biblioentry">
Fox, J., &amp; Weisberg, S. (2019). <em>An <span>R</span> companion to applied regression</em> (Third). Retrieved from <a href="https://socialsciences.mcmaster.ca/jfox/Books/Companion/">https://socialsciences.mcmaster.ca/jfox/Books/Companion/</a>
</div>
<div id="ref-galton1890kinship" class="csl-entry" role="doc-biblioentry">
Galton, F. (1890). Kinship and correlation. <em>The North American Review</em>, <em>150</em>(401), 419–431.
</div>
<div id="ref-hair1998multivariate" class="csl-entry" role="doc-biblioentry">
Hair, J. F., Black, W. C., Babin, B. J., Anderson, R. E., Tatham, R. L., &amp; others. (1998). <em>Multivariate data analysis</em> (Vol. 5). Prentice hall Upper Saddle River, NJ.
</div>
<div id="ref-gam" class="csl-entry" role="doc-biblioentry">
Hastie, T. (2020). <em>Gam: Generalized additive models</em>. Retrieved from <a href="https://CRAN.R-project.org/package=gam">https://CRAN.R-project.org/package=gam</a>
</div>
<div id="ref-hastie1986generalized" class="csl-entry" role="doc-biblioentry">
Hastie, T., Tibshirani, R., &amp; others. (1986). Generalized additive models. <em>Statistical Science</em>, <em>1</em>(3), 297–310.
</div>
<div id="ref-henderson1981building" class="csl-entry" role="doc-biblioentry">
Henderson, H. V., &amp; Velleman, P. F. (1981). Building multiple regression models interactively. <em>Biometrics</em>, 391–411.
</div>
<div id="ref-ggfortify" class="csl-entry" role="doc-biblioentry">
Horikoshi, M., &amp; Tang, Y. (2018). <em>Ggfortify: Data visualization tools for statistical analysis results</em>. Retrieved from <a href="https://CRAN.R-project.org/package=ggfortify">https://CRAN.R-project.org/package=ggfortify</a>
</div>
<div id="ref-huber1964" class="csl-entry" role="doc-biblioentry">
Huber, P. J. (1964). Robust estimation of a location parameter. <em>Ann. Math. Statist.</em>, <em>35</em>(1), 73–101. <a href="https://doi.org/10.1214/aoms/1177703732">https://doi.org/10.1214/aoms/1177703732</a>
</div>
<div id="ref-koenker1981note" class="csl-entry" role="doc-biblioentry">
Koenker, R. (1981). A note on studentizing a test for heteroscedasticity. <em>Journal of Econometrics</em>, <em>17</em>(1), 107–112.
</div>
<div id="ref-lindelov2019" class="csl-entry" role="doc-biblioentry">
Lindelov, J. K. (2019). <em>Common statistical tests are linear models (or: How to teach stats)</em>. Retrieved from <a href="https://lindeloev.github.io/tests-as-linear/">https://lindeloev.github.io/tests-as-linear/</a>
</div>
<div id="ref-luke2019multilevel" class="csl-entry" role="doc-biblioentry">
Luke, D. A. (2019). <em>Multilevel modeling</em> (Vol. 143). SAGE Publications, Incorporated.
</div>
<div id="ref-sjPlot" class="csl-entry" role="doc-biblioentry">
Lüdecke, D. (2020). <em>sjPlot: Data visualization for statistics in social science</em>. Retrieved from <a href="https://CRAN.R-project.org/package=sjPlot">https://CRAN.R-project.org/package=sjPlot</a>
</div>
<div id="ref-pearson1903law" class="csl-entry" role="doc-biblioentry">
Pearson, K. (1903). The law of ancestral heredity. <em>Biometrika</em>, <em>2</em>(2), 211–228.
</div>
<div id="ref-poldrack2018" class="csl-entry" role="doc-biblioentry">
Poldrack, R. A. (2018). <em>Statistical thinking for the 21st century</em>. Retrieved from <a href="https://statsthinking21.org">https://statsthinking21.org</a>
</div>
<div id="ref-rousseeuw1984least" class="csl-entry" role="doc-biblioentry">
Rousseeuw, P. J. (1984). Least median of squares regression. <em>Journal of the American Statistical Association</em>, <em>79</em>(388), 871–880.
</div>
<div id="ref-rousseeuw2006computing" class="csl-entry" role="doc-biblioentry">
Rousseeuw, P. J., &amp; Van Driessen, K. (2006). Computing LTS regression for large data sets. <em>Data Mining and Knowledge Discovery</em>, <em>12</em>(1), 29–45.
</div>
<div id="ref-ryan2008modern" class="csl-entry" role="doc-biblioentry">
Ryan, T. P. (2008). <em>Modern regression methods</em> (Vol. 655). John Wiley &amp; Sons.
</div>
<div id="ref-glmnet" class="csl-entry" role="doc-biblioentry">
Simon, N., Friedman, J., Hastie, T., &amp; Tibshirani, R. (2011). Regularization paths for cox’s proportional hazards model via coordinate descent. <em>Journal of Statistical Software</em>, <em>39</em>(5), 1–13. Retrieved from <a href="http://www.jstatsoft.org/v39/i05/">http://www.jstatsoft.org/v39/i05/</a>
</div>
<div id="ref-tibshirani1996regression" class="csl-entry" role="doc-biblioentry">
Tibshirani, R. (1996). Regression shrinkage and selection via the lasso. <em>Journal of the Royal Statistical Society: Series B (Methodological)</em>, <em>58</em>(1), 267–288.
</div>
<div id="ref-tikhonov1943stability" class="csl-entry" role="doc-biblioentry">
Tikhonov, A. N. (1943). On the stability of inverse problems. <em>Dokl. Akad. Nauk SSSR</em>, <em>39</em>, 195–198.
</div>
<div id="ref-ggplot2" class="csl-entry" role="doc-biblioentry">
Wickham, H. (2016). <em>ggplot2: Elegant graphics for data analysis</em>. Retrieved from <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>
</div>
<div id="ref-yule1897theory" class="csl-entry" role="doc-biblioentry">
Yule, G. U. (1897). On the theory of correlation. <em>Journal of the Royal Statistical Society</em>, <em>60</em>(4), 812–854.
</div>
<div id="ref-lmtest" class="csl-entry" role="doc-biblioentry">
Zeileis, A., &amp; Hothorn, T. (2002). Diagnostic checking in regression relationships. <em>R News</em>, <em>2</em>(3), 7–10. Retrieved from <a href="https://CRAN.R-project.org/doc/Rnews/">https://CRAN.R-project.org/doc/Rnews/</a>
</div>
</div>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>variáveis dependentes binárias ou discretas serão apresentadas na <a href="7-Regressao_Logistica.html">aula de Regressão Logística</a><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>regressão também é o motor que tem por de trás de quase todos os algoritmos e modelos de <em>machine learning</em>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3" role="doc-endnote"><p>tecnicamente reta aqui se refere um hiperplano que é subespaço de dimensão <span class="math inline">\(n-1\)</span> de um espaço de dimensão <span class="math inline">\(n\)</span>. Por exemplo, uma reta é um hiperplano 1-D de uma plano 2-D; um plano 2-D é um hiperplano de um plano 3-D; e assim por diante…<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4" role="doc-endnote"><p>acreditamos que visualizações 3-D de dados somente são aplicáveis em dois contextos: se você está usando mapas nas suas visualizações ou se você possui uma impressora 3D. Como não estamos fazendo nenhum dos dois, não nos aventuraremos em imagens 3D (#ficaadica).<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5" role="doc-endnote"><p>usando a técnica de Pearson.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6" role="doc-endnote"><p>tecnicamente podemos também pegar o valor absoluto de cada erro. Isto se chama erro absoluto médio (<em>mean absolute error</em> – MAE). Mas não possui as mesmas propriedades analíticas que o MSE e é computacionalmente menos estável.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7" role="doc-endnote"><p>Para os que tenham tido a oportunidade de estudar cálculo: estamos falando em achar o valor de <code>x</code> quando a derivada do MSE é zero (<span class="math inline">\(\text{MSE}^{\prime} = 0\)</span>).<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8" role="doc-endnote"><p>usando a técnica de Pearson.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9" role="doc-endnote"><p>convertemos <code>cyl</code> em fator para que, no gráfico <code>cyl</code> seja representado como quantidades discretas ao invés de contínuas.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10" role="doc-endnote"><p>muitas definições usam o termo “explicada” o que evitamos pois implica intuitivamente em uma relação causal.<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11" role="doc-endnote"><p>inclusive a função <code>aov()</code> de ANOVA por de baixo dos panos faz um chamado à função <code>lm()</code>. Ou seja é um <em>wrapper</em>, também chamado de açúcar sintático (<em>syntatic sugar</em>), da função <code>lm()</code>.<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12" role="doc-endnote"><p>Termo inglês: <em>M-estimation</em><a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13" role="doc-endnote"><p>Termo inglês: <em>least trimmed squares</em> – LTS<a href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
<h3 id="updates-and-corrections">Corrections</h3>
<p>If you see mistakes or want to suggest changes, please <a href="https://github.com/storopoli/Estatistica/issues/new">create an issue</a> on the source repository.</p>
<h3 id="reuse">Reuse</h3>
<p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>. Source code is available at <a href="https://github.com/storopoli/Estatistica">https://github.com/storopoli/Estatistica</a>, unless otherwise noted. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
<h3 id="citation">Citation</h3>
<p>For attribution, please cite this work as</p>
<pre class="citation-appendix short">Storopoli &amp; Vils (2021, Jan. 11). Estatística com R: Regressão Linear. Retrieved from https://storopoli.github.io/Estatistica/6-Regressao_Linear.html</pre>
<p>BibTeX citation</p>
<pre class="citation-appendix long">@misc{storopoli2021regressaolinearR,
  author = {Storopoli, Jose and Vils, Leonardo},
  title = {Estatística com R: Regressão Linear},
  url = {https://storopoli.github.io/Estatistica/6-Regressao_Linear.html},
  year = {2021}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<div class="distill-site-nav distill-site-footer">
<p>© Copyright 2020 <a href="https://github.com/storopoli/Estatistica">Jose Storopoli &amp; Leonardo Vils</a>.</p>
<p>Content licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>.</p>
</div>
<!--/radix_placeholder_navigation_after_body-->


</body>

</html>
